Source: https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases

[ Skip Navigation ](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases)
  * SwiftLanguage:  Swift  Objective-C 
Language: 
    * Swift 
    * [ Objective-C ](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases)


[](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases)
## [ StoreKit  ](https://developer.apple.com/documentation/storekit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
1 of 33 symbols inside <root>
In-App Purchase
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
2 of 33 symbols inside <root> containing 60 symbols[In-App Purchase](https://developer.apple.com/documentation/storekit/in-app-purchase)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
1 of 60 symbols inside -1505352393 
In-App Purchase merchandising
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
2 of 60 symbols inside -1505352393 containing 83 symbols[StoreKit views](https://developer.apple.com/documentation/storekit/storekit-views)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
3 of 60 symbols inside -1505352393 
Product and subscription information
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
4 of 60 symbols inside -1505352393 [Implementing a store in your app using the StoreKit API](https://developer.apple.com/documentation/storekit/implementing-a-store-in-your-app-using-the-storekit-api)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
5 of 60 symbols inside -1505352393 containing 45 symbols[Product](https://developer.apple.com/documentation/storekit/product)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
6 of 60 symbols inside -1505352393 containing 24 symbols[Product.SubscriptionInfo](https://developer.apple.com/documentation/storekit/product/subscriptioninfo)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
T
7 of 60 symbols inside -1505352393 [SubscriptionInfo](https://developer.apple.com/documentation/storekit/subscriptioninfo)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
T
8 of 60 symbols inside -1505352393 [SubscriptionStatus](https://developer.apple.com/documentation/storekit/subscriptionstatus)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
9 of 60 symbols inside -1505352393 
Purchase requests and results
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
10 of 60 symbols inside -1505352393 containing 4 symbols[PurchaseAction](https://developer.apple.com/documentation/storekit/purchaseaction)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
M
11 of 60 symbols inside -1505352393 [func purchase(options: Set<Product.PurchaseOption>) async throws -> Product.PurchaseResult](https://developer.apple.com/documentation/storekit/product/purchase\(options:\))
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
E
12 of 60 symbols inside -1505352393 containing 4 symbols[Product.PurchaseResult](https://developer.apple.com/documentation/storekit/product/purchaseresult)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
13 of 60 symbols inside -1505352393 
Transaction history and entitlements
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
14 of 60 symbols inside -1505352393 containing 41 symbols[Transaction](https://developer.apple.com/documentation/storekit/transaction)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
P
15 of 60 symbols inside -1505352393 [static var updates: Transaction.Transactions](https://developer.apple.com/documentation/storekit/transaction/updates)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
P
16 of 60 symbols inside -1505352393 [static var all: Transaction.Transactions](https://developer.apple.com/documentation/storekit/transaction/all)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
55 of 60 symbols inside -1505352393 [Generating JWS to sign App Store requests](https://developer.apple.com/documentation/storekit/generating-jws-to-sign-app-store-requests)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
56 of 60 symbols inside -1505352393 
Errors
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
56 of 60 symbols inside -1505352393 
Errors
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
E
57 of 60 symbols inside -1505352393 containing 8 symbols[StoreKitError](https://developer.apple.com/documentation/storekit/storekiterror)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
58 of 60 symbols inside -1505352393 
Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
59 of 60 symbols inside -1505352393 [Choosing a StoreKit API for In-App Purchases](https://developer.apple.com/documentation/storekit/choosing-a-storekit-api-for-in-app-purchases)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
60 of 60 symbols inside -1505352393 containing 60 symbols[Original API for In-App Purchase](https://developer.apple.com/documentation/storekit/original-api-for-in-app-purchase)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
1 of 60 symbols inside -864441183 
Essentials
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
2 of 60 symbols inside -864441183 [Setting up the transaction observer for the payment queue](https://developer.apple.com/documentation/storekit/setting-up-the-transaction-observer-for-the-payment-queue)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
3 of 60 symbols inside -864441183 [Offering, completing, and restoring in-app purchases](https://developer.apple.com/documentation/storekit/offering-completing-and-restoring-in-app-purchases)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
4 of 60 symbols inside -864441183 containing 27 symbols[SKPaymentQueue](https://developer.apple.com/documentation/storekit/skpaymentqueue)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
5 of 60 symbols inside -864441183 containing 15 symbols[SKPaymentTransactionObserver](https://developer.apple.com/documentation/storekit/skpaymenttransactionobserver)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
6 of 60 symbols inside -864441183 containing 4 symbols[SKPaymentQueueDelegate](https://developer.apple.com/documentation/storekit/skpaymentqueuedelegate)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
7 of 60 symbols inside -864441183 containing 6 symbols[SKRequest](https://developer.apple.com/documentation/storekit/skrequest)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
8 of 60 symbols inside -864441183 
Product information
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
9 of 60 symbols inside -864441183 [Loading in-app product identifiers](https://developer.apple.com/documentation/storekit/loading-in-app-product-identifiers)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
10 of 60 symbols inside -864441183 [Fetching product information from the App Store](https://developer.apple.com/documentation/storekit/fetching-product-information-from-the-app-store)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
11 of 60 symbols inside -864441183 containing 5 symbols[SKProductsRequest](https://developer.apple.com/documentation/storekit/skproductsrequest)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
12 of 60 symbols inside -864441183 containing 3 symbols[SKProductsResponse](https://developer.apple.com/documentation/storekit/skproductsresponse)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
13 of 60 symbols inside -864441183 containing 24 symbols[SKProduct](https://developer.apple.com/documentation/storekit/skproduct)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
14 of 60 symbols inside -864441183 
Storefronts
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
15 of 60 symbols inside -864441183 containing 3 symbols[SKStorefront](https://developer.apple.com/documentation/storekit/skstorefront)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
16 of 60 symbols inside -864441183 
Purchases
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
17 of 60 symbols inside -864441183 [Requesting a payment from the App Store](https://developer.apple.com/documentation/storekit/requesting-a-payment-from-the-app-store)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
18 of 60 symbols inside -864441183 [Processing a transaction](https://developer.apple.com/documentation/storekit/processing-a-transaction)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
19 of 60 symbols inside -864441183 containing 12 symbols[SKPayment](https://developer.apple.com/documentation/storekit/skpayment)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
20 of 60 symbols inside -864441183 containing 9 symbols[SKMutablePayment](https://developer.apple.com/documentation/storekit/skmutablepayment)Deprecated
153 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ StoreKit ](https://developer.apple.com/documentation/storekit)
  * [ In-App Purchase ](https://developer.apple.com/documentation/storekit/in-app-purchase)
  * [ Original API for In-App Purchase ](https://developer.apple.com/documentation/storekit/original-api-for-in-app-purchase)
  * [ Offering, completing, and restoring in-app purchases ](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases)
  *     * [ In-App Purchase ](https://developer.apple.com/documentation/storekit/in-app-purchase)
    * [ Original API for In-App Purchase ](https://developer.apple.com/documentation/storekit/original-api-for-in-app-purchase)
    * Offering, completing, and restoring in-app purchases 


Sample Code
# Offering, completing, and restoring in-app purchases
Fetch, display, purchase, validate, and finish transactions in your app.
[ Download ](https://docs-assets.developer.apple.com/published/bf990e030bb6/OfferingCompletingAndRestoringInAppPurchases.zip)
iOS 16.0+iPadOS 16.0+macOS 13.0+tvOS 16.0+Xcode 15.0+
## [Overview](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#Overview)
Use the In-App Purchase API to give people the ability to purchase virtual goods within your app or directly from the App Store using the StoreKit framework. This sample code project demonstrates how to retrieve, display, and restore in-app purchases. First, you set up your app to register and use a single-transaction queue observer at launch. The transaction queue observer manages all payment transactions and handles all transaction states. Confirm that it’s a shared instance of a custom class that conforms to the [`SKPaymentTransactionObserver`](https://developer.apple.com/documentation/storekit/skpaymenttransactionobserver) protocol. Then, remove the transaction observer when the system is about to terminate the app. See [`Setting Up the Transaction Observer and Payment Queue`](https://developer.apple.com/documentation/storekit/setting-up-the-transaction-observer-for-the-payment-queue) for more information.
This sample code project, which builds the InAppPurchases app, supports the iOS, iPadOS, macOS, and tvOS platforms. After launching, the app queries the App Store about product identifiers in the `Products.plist` file. The app updates its UI with the App Store’s response, which may include available products for sale, unrecognized product identifiers, or both. The app also displays all available purchased and restored payment transactions.
### [Configure the sample code project](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#Configure-the-sample-code-project)
Before you can run and test this sample code project, you need to:
  1. Start with a completed app that supports in-app purchases and has some configured in-app purchases in App Store Connect. For more information, see [Overview for configuring in-app purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases).
  2. Create [a Sandbox Apple Account](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-a-sandbox-apple-account/) in App Store Connect.
  3. Open the sample code project in Xcode, select the target that you want to build, click Signing & Capabilities, and change its bundle identifier to one that supports in-app purchases.
  4. Choose the appropriate team from the Team pop-up menu to let Xcode automatically manage your provisioning profile. See [Assign a project to a team](https://help.apple.com/xcode/mac/current/#/dev23aab79b4) for details.
  5. Open the `ProductIds.plist` file in the sample and update its content with your existing in-app purchases product IDs.
  6. For iOS and tvOS devices, build and run the `InAppPurchases` and `InAppPurchasestvOS` targets, respectively, which the sample uses to build the app. If you have any code-signing issues, see [If a code signing error occurs](https://help.apple.com/xcode/mac/current/#/dev01865b392).
  7. For macOS, before building the `InAppPurchasesmacOS` target, sign out of the Mac App Store. Build the target, then launch the resulting app from the Finder the first time to obtain a receipt. See [`Sign in to the App Store with your Sandbox Apple Account`](https://developer.apple.com/documentation/storekit/testing-in-app-purchases-with-sandbox) for details.
  8. Upon launching, the app queries the App Store about the product identifiers in `ProductIds.plist`. When successful, it displays a list of products available for sale in the App Store. Tap any product in that list to purchase it. When you receive a prompt to authenticate the purchase, use your test user account. If the product request fails, see [`invalidProductIdentifiers`](https://developer.apple.com/documentation/storekit/skproductsresponse/invalidproductidentifiers) for reasons the App Store may return invalid product identifiers.


### [Display available products for sale with localized pricing](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#Display-available-products-for-sale-with-localized-pricing)
The sample configures the app so it confirms that the user has authorization to make payments on the device before presenting products for sale.
```
var isAuthorizedForPayments: Bool {
    return SKPaymentQueue.canMakePayments()
}

```

After the app confirms authorization, it sends a products request to the App Store to fetch localized product information. Querying the App Store ensures that the app only presents users with products available for purchase. The app initializes the products request with a list of product identifiers associated with products to sell in its UI. Be sure to keep a strong reference to the products request object; the system may release it before the request completes. See [Product ID](https://help.apple.com/app-store-connect/#/dev84b80958f) for more information.
```
fileprivate func fetchProducts(matchingIdentifiers identifiers: [String]) {
    // Create a set for the product identifiers.
    let productIdentifiers = Set(identifiers)
    
    // Initialize the product request with the above identifiers.
    productRequest = SKProductsRequest(productIdentifiers: productIdentifiers)
    productRequest.delegate = self
    
    // Send the request to the App Store.
    productRequest.start()
}

```

The App Store responds to the products request with an [`SKProductsResponse`](https://developer.apple.com/documentation/storekit/skproductsresponse) object. Its [`products`](https://developer.apple.com/documentation/storekit/skproductsresponse/products) property contains information about all the products that are available for purchase in the App Store. The app uses this property to update its UI. The response’s `invalidProductIdentifiers` property includes all product identifiers that the App Store doesn’t recognize. See `invalidProductIdentifiers` for reasons the App Store may return invalid product identifiers.
```
// Contains products with identifiers that the App Store recognizes. As such, they are available for purchase.
if !response.products.isEmpty {
    availableProducts = response.products
}


// invalidProductIdentifiers contains all product identifiers that the App Store doesn’t recognize.
if !response.invalidProductIdentifiers.isEmpty {
    invalidProductIdentifiers = response.invalidProductIdentifiers
}

```

To display the price of a product in the UI, the app uses the locale and currency that the App Store returns. For instance, consider a user who is logged in to the French App Store and their device uses the United States locale. When attempting to purchase a product, the App Store displays the product’s price in Euros. Converting and showing the product’s price in U.S. dollars to match the device’s locale would be incorrect.
```
extension SKProduct {
    /// - returns: The cost of the product formatted in the local currency.
    var regularPrice: String? {
        let formatter = NumberFormatter()
        formatter.numberStyle = .currency
        formatter.locale = self.priceLocale
        return formatter.string(from: self.price)
    }
}

```

### [Interact with the app to purchase products](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#Interact-with-the-app-to-purchase-products)
Users can tap any product available for sale in the UI to purchase it. The app allows users to restore non-consumable products and auto-renewable subscriptions. The sample implements the Restore button and Settings > Restore all restorable purchases to implement this feature in the iOS and tvOS version of the app, respectively. It implements the Store > Restore menu item to restore purchases in the macOS version of the app.
Tapping any purchased item brings up purchase information, such as product identifier, transaction identifier, and transaction date. When the purchase is a restored one, the purchase information also contains its original transaction’s identifier and date.
### [Handle payment transaction states](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#Handle-payment-transaction-states)
When a transaction is pending in the payment queue, StoreKit notifies the app’s transaction observer by calling its [`paymentQueue(_:updatedTransactions:)`](https://developer.apple.com/documentation/storekit/skpaymenttransactionobserver/paymentqueue\(_:updatedtransactions:\)) method. Every transaction has five possible states, including [`SKPaymentTransactionState.purchasing`](https://developer.apple.com/documentation/storekit/skpaymenttransactionstate/purchasing), [`SKPaymentTransactionState.purchased`](https://developer.apple.com/documentation/storekit/skpaymenttransactionstate/purchased), [`SKPaymentTransactionState.failed`](https://developer.apple.com/documentation/storekit/skpaymenttransactionstate/failed), [`SKPaymentTransactionState.restored`](https://developer.apple.com/documentation/storekit/skpaymenttransactionstate/restored), and [`SKPaymentTransactionState.deferred`](https://developer.apple.com/documentation/storekit/skpaymenttransactionstate/deferred). For more information, see [`SKPaymentTransactionState`](https://developer.apple.com/documentation/storekit/skpaymenttransactionstate). The observer’s `paymentQueue(_:updatedTransactions:)` needs to be able to respond to any of these states at any time.
```
func paymentQueue(_ queue: SKPaymentQueue, updatedTransactions transactions: [SKPaymentTransaction]) {
    for transaction in transactions {
        switch transaction.transactionState {
        case .purchasing: break
        // Don’t block the UI. Allow the user to continue using the app.
        case .deferred: print(Messages.deferred)
        // The purchase was successful.
        case .purchased: handlePurchased(transaction)
        // The transaction failed.
        case .failed: handleFailed(transaction)
        // There are restored products.
        case .restored: handleRestored(transaction)
        @unknown default: fatalError(Messages.unknownPaymentTransaction)
        }
    }
}

```

When a transaction fails, the app inspects the [`error`](https://developer.apple.com/documentation/storekit/skpaymenttransaction/error) property to determine what happened. The app only displays errors with code that is different from [`paymentCancelled`](https://developer.apple.com/documentation/storekit/skerror/paymentcancelled).
```
// Don’t send any notifications when the user cancels the purchase.
if (transaction.error as? SKError)?.code != .paymentCancelled {
    DispatchQueue.main.async {
        self.delegate?.storeObserverDidReceiveMessage(message)
    }
}

```

When the user defers a transaction, apps need to allow them to continue using the UI while waiting for StoreKit to update the transaction.
### [Restore completed purchases](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#Restore-completed-purchases)
When users purchase non-consumables, auto-renewable subscriptions, or non-renewing subscriptions, they expect them to be available on all their devices indefinitely. The app provides a UI that allows users to restore their past purchases. See [`Understand Product Types`](https://developer.apple.com/documentation/storekit/original-api-for-in-app-purchase#Understand-product-types) for more information.
```
@IBAction func restore(_ sender: UIBarButtonItem) {
    // Calls StoreObserver to restore all restorable purchases.
    StoreObserver.shared.restore()
}

```

The sample uses [`restoreCompletedTransactions()`](https://developer.apple.com/documentation/storekit/skpaymentqueue/restorecompletedtransactions\(\)) to restore non-consumables and auto-renewable subscriptions. StoreKit notifies the app’s transaction observer by calling `paymentQueue(_:updatedTransactions:)` with a transaction state of `.restored` for each restored transaction. Restoring non-renewing subscriptions isn’t within the scope of this sample code project. For information about restore failures, see `restoreCompletedTransactions()`.
### [Provide content and finish the transaction](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#Provide-content-and-finish-the-transaction)
Apps need to deliver the content or unlock the purchased functionality after receiving a transaction with a state of `.purchased` or `.restored`. These states indicate that the App Store has received a payment for a product from the user.
Unfinished transactions stay in the payment queue. StoreKit calls the app’s persistent observer’s `paymentQueue(_:updatedTransactions:)` each time upon launching or resuming from the background until the app finishes these transactions. As a result, the App Store may repeatedly prompt users to authenticate their purchases or prevent them from purchasing products from the app.
The sample calls [`finishTransaction(_:)`](https://developer.apple.com/documentation/storekit/skpaymentqueue/finishtransaction\(_:\)) on transactions with a state of `.failed`, `.purchased`, or `.restored` to remove them from the queue. Finished transactions aren’t recoverable. Therefore, apps need to provide the purchased content or complete their purchase process before finishing transactions.
```
// Finish the successful transaction.
SKPaymentQueue.default().finishTransaction(transaction)

```

## [See Also](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#see-also)
### [Essentials](https://developer.apple.com/documentation/StoreKit/offering-completing-and-restoring-in-app-purchases#Essentials)
[Setting up the transaction observer for the payment queue](https://developer.apple.com/documentation/storekit/setting-up-the-transaction-observer-for-the-payment-queue)
Enable your app to receive and handle transactions by adding an observer.
[`class SKPaymentQueue`](https://developer.apple.com/documentation/storekit/skpaymentqueue)
A queue of payment transactions for the App Store to process.
Deprecated
[`protocol SKPaymentTransactionObserver`](https://developer.apple.com/documentation/storekit/skpaymenttransactionobserver)
A set of methods that process transactions, unlock purchased functionality, and continue promoted In-App Purchases.
Deprecated
[`protocol SKPaymentQueueDelegate`](https://developer.apple.com/documentation/storekit/skpaymentqueuedelegate)
The protocol that provides information needed to complete transactions.
Deprecated
[`class SKRequest`](https://developer.apple.com/documentation/storekit/skrequest)
An abstract class that represents a request to the App Store.
Deprecated
Current page is Offering, completing, and restoring in-app purchases 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2FStoreKit%2Foffering-completing-and-restoring-in-app-purchases).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
