Source: https://developer.apple.com/documentation/createml/creating-a-text-classifier-model

[ Skip Navigation ](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model)
  * SwiftLanguage: Swift


[](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model)
## [ Create ML  ](https://developer.apple.com/documentation/createml)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
6 of 58 symbols inside <root>
Video models
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
7 of 58 symbols inside <root> containing 3 symbols[Creating an Action Classifier Model](https://developer.apple.com/documentation/createml/creating-an-action-classifier-model)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
8 of 58 symbols inside <root> [Detecting human actions in a live video feed](https://developer.apple.com/documentation/createml/detecting-human-actions-in-a-live-video-feed)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
9 of 58 symbols inside <root> containing 35 symbols[MLActionClassifier](https://developer.apple.com/documentation/createml/mlactionclassifier)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
10 of 58 symbols inside <root> containing 35 symbols[MLHandActionClassifier](https://developer.apple.com/documentation/createml/mlhandactionclassifier)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
11 of 58 symbols inside <root> containing 27 symbols[MLStyleTransfer](https://developer.apple.com/documentation/createml/mlstyletransfer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
12 of 58 symbols inside <root>
Text models
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
13 of 58 symbols inside <root> [Creating a text classifier model](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
14 of 58 symbols inside <root> [Creating a word tagger model](https://developer.apple.com/documentation/createml/creating-a-word-tagger-model)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
15 of 58 symbols inside <root> containing 31 symbols[MLTextClassifier](https://developer.apple.com/documentation/createml/mltextclassifier)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
16 of 58 symbols inside <root> containing 31 symbols[MLWordTagger](https://developer.apple.com/documentation/createml/mlwordtagger)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
17 of 58 symbols inside <root> containing 22 symbols[MLGazetteer](https://developer.apple.com/documentation/createml/mlgazetteer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
18 of 58 symbols inside <root> containing 24 symbols[MLWordEmbedding](https://developer.apple.com/documentation/createml/mlwordembedding)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
19 of 58 symbols inside <root>
Sound models
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
20 of 58 symbols inside <root> containing 35 symbols[MLSoundClassifier](https://developer.apple.com/documentation/createml/mlsoundclassifier)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
21 of 58 symbols inside <root>
Motion models
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
22 of 58 symbols inside <root> containing 36 symbols[MLActivityClassifier](https://developer.apple.com/documentation/createml/mlactivityclassifier)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
23 of 58 symbols inside <root>
Tabular models
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
24 of 58 symbols inside <root> [Creating a model from tabular data](https://developer.apple.com/documentation/createml/creating-a-model-from-tabular-data)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
E
25 of 58 symbols inside <root> containing 34 symbols[MLClassifier](https://developer.apple.com/documentation/createml/mlclassifier)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
E
26 of 58 symbols inside <root> containing 32 symbols[MLRegressor](https://developer.apple.com/documentation/createml/mlregressor)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
27 of 58 symbols inside <root> containing 22 symbols[MLRecommender](https://developer.apple.com/documentation/createml/mlrecommender)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
28 of 58 symbols inside <root>
Tabular data
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
29 of 58 symbols inside <root> containing 56 symbols[MLDataTable](https://developer.apple.com/documentation/createml/mldatatable)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
E
30 of 58 symbols inside <root> containing 37 symbols[MLDataValue](https://developer.apple.com/documentation/createml/mldatavalue)
58 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ Create ML ](https://developer.apple.com/documentation/createml)
  * [ Creating a text classifier model ](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model)
  *     * Creating a text classifier model 


Article
# Creating a text classifier model
Train a machine learning model to classify natural language text.
## [Overview](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Overview)
A text classifier is a machine learning model that’s been trained to recognize patterns in natural language text, like the sentiment expressed by a sentence.
![Diagram showing how a text string maps to a label.](https://docs-assets.developer.apple.com/published/8b58fe67739dc2f7f3bb472ed54312b3/creating-a-text-classifer-model-1%402x.png)
You train a text classifier by showing it lots of examples of text you’ve already labeled—for example, movie reviews that you’ve already labeled as positive, negative, or neutral.
![Diagram showing how you train a text classifier with Create ML using training data.](https://docs-assets.developer.apple.com/published/928f87b97f9f6bea77d959ecc545107a/creating-a-text-classifer-model-2%402x.png)
### [Import your data](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Import-your-data)
Start by gathering textual data and importing it into an [`MLDataTable`](https://developer.apple.com/documentation/createml/mldatatable) instance. You can create a data table from JSON and CSV formats. Or, if your textual data is in a collection of files, you can sort them into folders, using the folder names as labels, similar to the image data source used in [Creating an Image Classifier Model](https://developer.apple.com/documentation/createml/creating-an-image-classifier-model).
As an example, consider a JSON file containing movie reviews that you’ve categorized by sentiment. Each entry contains a pair of keys, the `text` and the `label`. The values of those keys are the input samples used to train your model. The JSON snippet below shows three pairs of sentences with their sentiment labels.
```
// JSON file
[
    {
        "text": "The movie was fantastic!",
        "label": "positive"
    }, {
        "text": "Very boring. Fell asleep.",
        "label": "negative"
    }, {
        "text": "It was just OK.",
        "label": "neutral"
    } ...
]

```

In a macOS playground, create a data frame using the [TabularData](https://developer.apple.com/documentation/TabularData) framework.
```
import TabularData


let data = try DataFrame(contentsOfJSONFile: URL(fileURLWithPath: "<#/path/to/read/data.json#>"))

```

The resulting data frame has two columns, named _text_ and _label_ , derived from the keys in the JSON file. The column names can be anything, as long as they are meaningful to you, because you’ll use them as parameters in other methods.
### [Prepare your data for training and evaluation](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Prepare-your-data-for-training-and-evaluation)
The data you use to train your model needs to be different from the data you use to evaluate your model. Use the [`stratifiedSplit(on:by:randomSeed:)`](https://developer.apple.com/documentation/TabularData/DataFrameProtocol/stratifiedSplit\(on:by:randomSeed:\)-9iauf) method to split your data into two data frames, one for training and the other for testing. The training data frame contains the majority of your data, and the testing data frame contains the remaining 20 percent.
```
let (trainingData, testingData) = data.stratifiedSplit(on: "text", by: 0.8)

```

### [Choose model training parameters](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Choose-model-training-parameters)
You can use model training parameters to control the learning process. Choose a classifier algorithm type by specifying the [`MLTextClassifier.ModelAlgorithmType`](https://developer.apple.com/documentation/createml/mltextclassifier/modelalgorithmtype) parameter. The [`MLTextClassifier.ModelAlgorithmType.maxEnt(revision:)`](https://developer.apple.com/documentation/createml/mltextclassifier/modelalgorithmtype/maxent\(revision:\)) algorithm trains quickly and performs well for a wide variety of data. It’s a good starting point algorithm while you’re exploring your data and models.
You can choose a transfer learning algorithm, [`MLTextClassifier.ModelAlgorithmType.transferLearning(_:revision:)`](https://developer.apple.com/documentation/createml/mltextclassifier/modelalgorithmtype/transferlearning\(_:revision:\)). Transfer learning models use a pre-trained model as a feature extractor, you specify the [`MLTextClassifier.FeatureExtractorType`](https://developer.apple.com/documentation/createml/mltextclassifier/featureextractortype). Transfer learning models can take longer to train, but can improve accuracy because the baseline model has already been trained on a large amount of text in a specific language.
If your data contains multiple languages, choose either the maximum entropy algorithm [`MLTextClassifier.ModelAlgorithmType.maxEnt(revision:)`](https://developer.apple.com/documentation/createml/mltextclassifier/modelalgorithmtype/maxent\(revision:\)) or the transfer learning algorithm [`MLTextClassifier.ModelAlgorithmType.transferLearning(_:revision:)`](https://developer.apple.com/documentation/createml/mltextclassifier/modelalgorithmtype/transferlearning\(_:revision:\)) and set its [`MLTextClassifier.FeatureExtractorType`](https://developer.apple.com/documentation/createml/mltextclassifier/featureextractortype) to the Bidirectional Encoder Representations from Transformers (BERT) embedding feature extractor [`MLTextClassifier.FeatureExtractorType.bertEmbedding`](https://developer.apple.com/documentation/createml/mltextclassifier/featureextractortype/bertembedding).
If your data contains a single language, use the conditional random fields algorithm [`MLTextClassifier.ModelAlgorithmType.crf(revision:)`](https://developer.apple.com/documentation/createml/mltextclassifier/modelalgorithmtype/crf\(revision:\)) or the transfer learning algorithm [`MLTextClassifier.ModelAlgorithmType.transferLearning(_:revision:)`](https://developer.apple.com/documentation/createml/mltextclassifier/modelalgorithmtype/transferlearning\(_:revision:\)) and set its [`MLTextClassifier.FeatureExtractorType`](https://developer.apple.com/documentation/createml/mltextclassifier/featureextractortype) to the Embeddings from Language Models (ELMo) embedding feature extractor [`MLTextClassifier.FeatureExtractorType.elmoEmbedding`](https://developer.apple.com/documentation/createml/mltextclassifier/featureextractortype/elmoembedding).
Use the [`MLTextClassifier.ModelParameters.ValidationData`](https://developer.apple.com/documentation/createml/mltextclassifier/modelparameters-swift.struct/validationdata-swift.enum) parameter to specify the evaluation data that’s held out from training your model. During the training process, use the validation data to estimate your model’s ability to correctly classify new examples. Depending on the validation accuracy, the classifier algorithm might adjust values within the model — or stop the training process, if the accuracy is high enough. Since the split of your data is random, you might get a different result each time you train your model.
```
let parameters = MLTextClassifier.ModelParameters(
    validation: .split(strategy: .automatic),
    algorithm: .transferLearning(.bertEmbedding, revision: 1),
    language: .english
)

```

### [Create and train a text classifier](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Create-and-train-a-text-classifier)
Create an instance of [`MLTextClassifier`](https://developer.apple.com/documentation/createml/mltextclassifier) with your training data frame and the column names.
```
let sentimentClassifier = try MLTextClassifier(
    trainingData: trainingData,
    textColumn: "text",
    labelColumn: "label",
    parameters: parameters
)

```

To measure how accurately the model (`sentimentClassifier`) performs on the training and validation data, use the [`classificationError`](https://developer.apple.com/documentation/createml/mlclassifiermetrics/classificationerror) properties of the model’s [`trainingMetrics`](https://developer.apple.com/documentation/createml/mltextclassifier/trainingmetrics) and [`validationMetrics`](https://developer.apple.com/documentation/createml/mltextclassifier/validationmetrics) properties.
```
// Calculate training accuracy as a percentage.
let trainingAccuracy = (1.0 - sentimentClassifier.trainingMetrics.classificationError) * 100


// Calculate validation accuracy as a percentage.
let validationAccuracy = (1.0 - sentimentClassifier.validationMetrics.classificationError) * 100

```

### [Evaluate a classifier’s accuracy](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Evaluate-a-classifiers-accuracy)
Next, evaluate your trained model’s performance by testing it against sentences it’s never seen before. Pass your testing data frame to the [`evaluation(on:)`](https://developer.apple.com/documentation/createml/mltextclassifier/evaluation\(on:\)-8ch4k) method, which returns an [`MLClassifierMetrics`](https://developer.apple.com/documentation/createml/mlclassifiermetrics) instance.
```
let evaluationMetrics = sentimentClassifier.evaluation(on: testingData, textColumn: "text", labelColumn: "label")

```

To get the evaluation accuracy, use the [`classificationError`](https://developer.apple.com/documentation/createml/mlclassifiermetrics/classificationerror) property of the returned [`MLClassifierMetrics`](https://developer.apple.com/documentation/createml/mlclassifiermetrics) instance.
```
// Calculate evaluation accuracy as a percentage.
let evaluationAccuracy = (1.0 - evaluationMetrics.classificationError) * 100

```

If the evaluation performance isn’t good enough, you may need to retrain with more data or make other adjustments. For information about improving model performance, see [Improving Your Model’s Accuracy](https://developer.apple.com/documentation/createml/improving-your-model-s-accuracy).
### [Save a Core ML model](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Save-a-Core-ML-model)
When your model is performing well enough, you’re ready to save it so you can use it in your app. Use the [`write(to:metadata:)`](https://developer.apple.com/documentation/createml/mltextclassifier/write\(to:metadata:\)) method to write the Core ML model file to disk. Provide any information about the model, like its author, version, or description in an [`MLModelMetadata`](https://developer.apple.com/documentation/createml/mlmodelmetadata) instance.
```
let metadata = MLModelMetadata(author: "John Appleseed",
                               shortDescription: "A model trained to classify movie review sentiment",
                               version: "1.0")


try sentimentClassifier.write(to: URL(fileURLWithPath: "<#/path/to/save/SentimentClassifier.mlmodel#>"),
                              metadata: metadata)

```

Specify the file name using the `fileURLWithPath:` parameter, in the above code, `SentimentClassifier.mlmodel`.
### [Add a Core ML model to your app](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Add-a-Core-ML-model-to-your-app)
With your app open in Xcode, drag the `SentimentClassifier.mlmodel` file into the navigation pane. Xcode compiles the model and generates a `SentimentClassifier` class for use in your app. Select the `SentimentClassifier.mlmodel` file in Xcode to view additional information about the model.
Create an [`NLModel`](https://developer.apple.com/documentation/NaturalLanguage/NLModel) in the Natural Language framework from the `SentimentClassifier` to ensure that the tokenization is consistent between training and deployment. Then use [`predictedLabel(for:)`](https://developer.apple.com/documentation/NaturalLanguage/NLModel/predictedLabel\(for:\)) to generate predictions on new text inputs.
```
import NaturalLanguage
import CoreML


let mlModel = try SentimentClassifier(configuration: MLModelConfiguration()).model


let sentimentPredictor = try NLModel(mlModel: mlModel)
sentimentPredictor.predictedLabel(for: "It was the best I've ever seen!")

```

## [See Also](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#see-also)
### [Text models](https://developer.apple.com/documentation/createml/creating-a-text-classifier-model#Text-models)
[Creating a word tagger model](https://developer.apple.com/documentation/createml/creating-a-word-tagger-model)
Train a machine learning model to tag individual words in natural language text.
[`struct MLTextClassifier`](https://developer.apple.com/documentation/createml/mltextclassifier)
A model you train to classify natural language text.
[`struct MLWordTagger`](https://developer.apple.com/documentation/createml/mlwordtagger)
A word-tagging model you train to classify natural language text at the word level.
[`struct MLGazetteer`](https://developer.apple.com/documentation/createml/mlgazetteer)
A collection of terms and their labels, which augments a tagger that analyzes natural language text.
[`struct MLWordEmbedding`](https://developer.apple.com/documentation/createml/mlwordembedding)
A map of strings in a vector space that enable your app to find similar strings by looking at a string’s neighbors.
Current page is Creating a text classifier model 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fcreateml%2Fcreating-a-text-classifier-model).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
