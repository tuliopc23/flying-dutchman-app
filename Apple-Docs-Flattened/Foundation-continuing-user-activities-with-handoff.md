Source: https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff

[ Skip Navigation ](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff)
  * SwiftLanguage: Swift


[](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff)
## [ Foundation  ](https://developer.apple.com/documentation/foundation)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
24 of 27 symbols inside 2084705811 containing 5 symbols[NSUserNotificationCenterDelegate](https://developer.apple.com/documentation/foundation/nsusernotificationcenterdelegate)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
6 of 27 symbols inside 2084705811 
Operations
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
7 of 27 symbols inside 2084705811 containing 27 symbols[Operation](https://developer.apple.com/documentation/foundation/operation)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
8 of 27 symbols inside 2084705811 containing 28 symbols[OperationQueue](https://developer.apple.com/documentation/foundation/operationqueue)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
9 of 27 symbols inside 2084705811 containing 4 symbols[BlockOperation](https://developer.apple.com/documentation/foundation/blockoperation)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
10 of 27 symbols inside 2084705811 
Scheduling
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
11 of 27 symbols inside 2084705811 containing 23 symbols[Timer](https://developer.apple.com/documentation/foundation/timer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
12 of 27 symbols inside 2084705811 
Activity Sharing
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
13 of 27 symbols inside 2084705811 [Continuing User Activities with Handoff](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
14 of 27 symbols inside 2084705811 [Implementing Handoff in Your App](https://developer.apple.com/documentation/foundation/implementing-handoff-in-your-app)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
15 of 27 symbols inside 2084705811 containing 75 symbols[NSUserActivity](https://developer.apple.com/documentation/foundation/nsuseractivity)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
16 of 27 symbols inside 2084705811 containing 5 symbols[NSUserActivityDelegate](https://developer.apple.com/documentation/foundation/nsuseractivitydelegate)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
17 of 27 symbols inside 2084705811 
System Interaction
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
18 of 27 symbols inside 2084705811 containing 54 symbols[ProcessInfo](https://developer.apple.com/documentation/foundation/processinfo)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
19 of 27 symbols inside 2084705811 containing 17 symbols[NSBackgroundActivityScheduler](https://developer.apple.com/documentation/foundation/nsbackgroundactivityscheduler)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
20 of 27 symbols inside 2084705811 
User Notifications
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
21 of 27 symbols inside 2084705811 containing 33 symbols[NSUserNotification](https://developer.apple.com/documentation/foundation/nsusernotification)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
22 of 27 symbols inside 2084705811 containing 5 symbols[NSUserNotificationAction](https://developer.apple.com/documentation/foundation/nsusernotificationaction)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
23 of 27 symbols inside 2084705811 containing 13 symbols[NSUserNotificationCenter](https://developer.apple.com/documentation/foundation/nsusernotificationcenter)Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
24 of 27 symbols inside 2084705811 containing 5 symbols[NSUserNotificationCenterDelegate](https://developer.apple.com/documentation/foundation/nsusernotificationcenterdelegate)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
25 of 27 symbols inside 2084705811 
Combine Integration
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
T
26 of 27 symbols inside 2084705811 [Published](https://developer.apple.com/documentation/foundation/published)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
T
27 of 27 symbols inside 2084705811 [ObservableObject](https://developer.apple.com/documentation/foundation/observableobject)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
11 of 64 symbols inside <root> containing 5 symbols[Resources](https://developer.apple.com/documentation/foundation/resources)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
12 of 64 symbols inside <root> containing 8 symbols[Notifications](https://developer.apple.com/documentation/foundation/notifications)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
13 of 64 symbols inside <root> containing 12 symbols[App Extension Support](https://developer.apple.com/documentation/foundation/app-extension-support)
91 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ Foundation ](https://developer.apple.com/documentation/foundation)
  * [ Task Management ](https://developer.apple.com/documentation/foundation/task-management)
  * [ Continuing User Activities with Handoff ](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff)
  *     * [ Task Management ](https://developer.apple.com/documentation/foundation/task-management)
    * Continuing User Activities with Handoff 


Sample Code
# Continuing User Activities with Handoff
Define and manage which of your app’s activities can be continued between devices.
[ Download ](https://docs-assets.developer.apple.com/published/fb0d52fad60a/ContinuingUserActivitiesWithHandoff.zip)
iOS 12.0+iPadOS 12.0+macOS 10.14+Xcode 15.0+
## [Overview](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#Overview)
This sample app searches for Apple Store locations and shows them on a map. The user can choose a store’s map annotation to see its address and mark it as a favorite. As the user changes visible regions or inspects individual stores, the app uses Handoff to share these activities with the user’s other devices. If the user changes devices, they can use Handoff to launch the app and return to what they were doing on the original device.
![Outlines of mobile and desktop devices, showing a specific point of interest on a map.](https://docs-assets.developer.apple.com/published/813a4ab0a97cc1f25dece547f1788a22/handoff-sample-code%402x.png)
The sample project builds for both macOS and iOS, so you can run it on a Mac, iPhone, and iPad. The project does not contain a watchOS or tvOS app.
### [Configure the Sample Code Project](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#Configure-the-Sample-Code-Project)
`HandoffMapViewer` must be run on actual devices; the iOS version cannot run in Simulator.
To configure your Mac to run the sample code project, open System Preferences and do the following:
  1. In Bluetooth settings, click Turn Bluetooth On.
  2. In iCloud settings, verify that you are signed into iCloud. If you are not, click Sign In and enter your Apple ID and password.
  3. In General settings, select “Allow Handoff between this Mac and your iCloud devices”.


To configure your iOS devices to run the sample code project, open the Settings app and do the following:
  1. In Bluetooth settings, tap to turn on Bluetooth.
  2. In the user banner at the top of Settings, tap to sign in with your Apple ID if you haven’t already. Then tap to turn on iCloud.
  3. In General settings, tap to turn on Handoff.


To configure the sample code project so that it can run on your devices, open the `HandoffMapViewer.xcodeproj` project in Xcode and do the following:
  1. Select the `HandoffMapViewer` project at the top of the Project Navigator, select the `HandoffMapViewerMac` target, select the “General” tab, and change the Bundle Identifier to a unique value, such as one that uses your organization’s name instead of `com.example`.
  2. With the `HandoffMapViewer` project still selected in the Project Navigator, select the `HandoffMapViewerIOS` target, select the “General” tab, and change the Bundle Identifier to the same value you used in the previous step.
  3. To run the macOS version, build the `HandoffMapViewerMac` target, and run it locally, or copy the application file from the `Products` folder to another Mac and run it there.
  4. To run the iOS version, build the `HandoffMapViewerIOS` target and run it on one of your connected iOS devices.


### [Define User Activities](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#Define-User-Activities)
You implement Handoff by determining specific activities that a user can perform in your app, and whose state you can reproduce on a second device. The sample app has two user activities:
  * Viewing a map region.
  * Viewing the details of a specific Apple Store and editing its “favorite” value.


Note
Be aware that your app usually has other persistence and synchronization strategies in addition to Handoff. For example, the sample app uses an iCloud key-value store to keep track of which stores have been marked as favorites. This way, the favorites data is available to the app if you launch it outside of Handoff, such as from the macOS Dock or the iOS Home screen.
You use the app’s `Info.plist` to tell Handoff which activities your app can continue, by providing an entry with the key name `NSUserActivityTypes`. The type of this entry is `Array`, and each member is a `String` representing a supported Handoff activity. In the sample app, the macOS and iOS targets include the `map-viewing` and `store-editing` activities in their `Info.plist` files.
```
<key>NSUserActivityTypes</key>
<array>
  <string>com.example.apple-samplecode.HandoffMapViewer.map-viewing</string>
  <string>com.example.apple-samplecode.HandoffMapViewer.store-editing</string>
</array>

```

### [Manage User Activities](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#Manage-User-Activities)
At runtime, you represent a user activity with the `NSUserActivity` type. You initialize a user activity object with a string identifier, the same one used earlier in the `Info.plist`. This object also has an `isEligibleForHandoff` property that exposes the activity to Handoff, and a `userInfo` dictionary containing data needed to recreate the app’s state on the receiving device.
In the sample app, the `MapViewController` manages two `NSUserActivity` instances: one each for the `map-viewing` and `store-editing` activities. When the map region changes, it sets the `userActivity` property (defined in `NSViewController` for macOS and `UIViewController` for iOS) to the `map-viewing` activity. It makes this the current activity, replacing any other activity that may have previously been sent to Handoff, and sets `needsSave` to `true`, indicating that the activity has new data to send to remote devices.
```
userActivity = mapViewingActivity
mapViewingActivity.needsSave = true
mapViewingActivity.becomeCurrent()

```

Calling `needsSave` on the view controller’s `userActivity` eventually results in a callback to the method `updateUserActivityState(_:)`, declared in `UIResponder` on iOS and `NSResponder` on macOS. This is the app’s opportunity to refresh the activity object’s `userInfo` before Handoff receives the activity. The implementation in the sample app calls a convenience function `updateViewingRegion(_:)`, defined in an extension on `NSUserActivity`, to encode the map view’s `MKCoordinateRegion` into key-value entries in the `userInfo` dictionary.
```
func updateViewingRegion(_ region: MKCoordinateRegion) {
    let updateDict = [
        NSUserActivity.regionCenterLatitudeKeyString: region.center.latitude,
        NSUserActivity.regionCenterLongitudeKeyString: region.center.longitude,
        NSUserActivity.regionSpanLatitudeKeyString: region.span.latitudeDelta,
        NSUserActivity.regionSpanLongitudeKeyString: region.span.longitudeDelta]
    addUserInfoEntries(from: updateDict)
}

```

### [Receive User Activities](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#Receive-User-Activities)
When you move to another device, macOS or iOS indicates that a Handoff activity is available. macOS displays a Handoff icon at the beginning of the Dock, with a badge indicating the type of source device. On iOS, the Handoff banner appears at the bottom of the screen in the app switcher, showing the app and source device name.
When you launch the app using the Handoff prompts, the system calls methods in `UIApplicationDelegate` (iOS) or `NSApplicationDelegate` (macOS) to provide the Handoff activity. The `application(_:continue:restorationHandler:)` method provides the activity, along with a completion handler that you call with an array of view controllers that can handle the activity. The implementation in the iOS app delegate just finds and passes the first view controller, an instance of `MapViewController`.
```
func application(_ application: UIApplication, continue userActivity: NSUserActivity,
                 restorationHandler: @escaping ([UIUserActivityRestoring]?) -> Void) -> Bool {
    guard let topNav = application.keyWindow?.rootViewController as? UINavigationController,
        let mapVC = topNav.viewControllers.first as? MapViewController else {
        return false
    }
    
    mapVC.loadView()
    restorationHandler([mapVC])
    return true
}

```

The implementation in the macOS app delegate is similar, except that it traverses the key window’s hierarchy, rather than the iOS navigation controller stack:
```
func application(_ application: NSApplication, continue userActivity: NSUserActivity,
                 restorationHandler: @escaping ([NSUserActivityRestoring]) -> Void) -> Bool {
    guard let mapVC = application.keyWindow?.windowController?.contentViewController as? MapViewController else {
        return false
    }
    
    mapVC.loadView()
    restorationHandler([mapVC])
    return true
}

```

### [Update the App’s State](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#Update-the-Apps-State)
The view controllers receive the `NSUserActivity` in the `restoreUserActivityState(_:)` method. `MapViewController` inspects the activity to determine whether it is the map-viewing or the store-editing activity, and then updates the UI as needed. The map-viewing activity case resets the map region, by creating a new `MKCoordinateRegion` from the values in the `userInfo`.
```
func viewingRegion() -> MKCoordinateRegion? {
    guard let centerLatitude = userInfo?[NSUserActivity.regionCenterLatitudeKeyString] as? CLLocationDegrees,
        let centerLongitude = userInfo?[NSUserActivity.regionCenterLongitudeKeyString] as? CLLocationDegrees,
        let spanLatitude = userInfo?[NSUserActivity.regionSpanLatitudeKeyString] as? CLLocationDegrees,
        let spanLongitude = userInfo?[NSUserActivity.regionSpanLongitudeKeyString] as? CLLocationDegrees else {
            return nil
    }
    return MKCoordinateRegion(center: CLLocationCoordinate2D(latitude: centerLatitude,
                                                             longitude: centerLongitude),
                              span: MKCoordinateSpan(latitudeDelta: spanLatitude,
                                                     longitudeDelta: spanLongitude))
}

```

In the case of the store-editing activity, the view controller also retrieves the store’s URL and location coordinates from the `userInfo`. The app waits until the map adds a `MKAnnotationView` for the store being edited, so it knows where to anchor the popover.
### [Update the Original Device’s State (Optional)](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#Update-the-Original-Devices-State-Optional)
The `NSUserActivity` class has a `delegate` property of type `NSUserActivityDelegate`. This notifies the originating device when you continue an activity on another device. The originating device can use this to clean up its own UI state.
In the sample app, tapping a pin for an Apple Store shows a popover with details about the store and a switch (iOS) or checkbox (macOS) to mark the store as a favorite. The `MapViewContoller` represents this activity as the `storeEditingActivity` property, and sets itself as the activity’s delegate. When you continue editing on a second device, the delegate on the originating device receives a notification that this activity has been continued, and dismisses its own popover.
```
func userActivityWasContinued(_ userActivity: NSUserActivity) {
    DispatchQueue.main.async {[weak self] in
        if let detailVC = self?.presentedViewController as? StoreDetailViewController,
           userActivity.activityType == NSUserActivity.storeEditingActivityType {
            detailVC.dismiss(animated: true)
        }
    }
}

```

Note
Not all apps need to update the state of the originating app. In the sample app, dismissing the popover is meant as a gentle reminder to not make simultaneous edits from two devices. This is neither explicitly prohibited nor supported in the sample.
## [See Also](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#see-also)
### [Activity Sharing](https://developer.apple.com/documentation/foundation/continuing-user-activities-with-handoff#Activity-Sharing)
[Implementing Handoff in Your App](https://developer.apple.com/documentation/foundation/implementing-handoff-in-your-app)
Create, send, and receive user activities directly.
[`class NSUserActivity`](https://developer.apple.com/documentation/foundation/nsuseractivity)
A representation of the state of your app at a moment in time.
[`protocol NSUserActivityDelegate`](https://developer.apple.com/documentation/foundation/nsuseractivitydelegate)
The interface through which a user activity instance notifies its delegate of updates.
Current page is Continuing User Activities with Handoff 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Ffoundation%2Fcontinuing-user-activities-with-handoff).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
