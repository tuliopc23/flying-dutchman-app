Source: https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps

[ Skip Navigation ](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps)
  * SwiftLanguage:  Swift  Objective-C 
Language: 
    * Swift 
    * [ Objective-C ](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps)


[](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps)
## [ UIKit  ](https://developer.apple.com/documentation/uikit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
1 of 46 symbols inside <root>
Essentials
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
2 of 46 symbols inside <root> [Adopting Liquid Glass](https://developer.apple.com/documentation/technologyoverviews/adopting-liquid-glass)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
3 of 46 symbols inside <root> [UIKit updates](https://developer.apple.com/documentation/updates/uikit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
4 of 46 symbols inside <root> [About App Development with UIKit](https://developer.apple.com/documentation/uikit/about-app-development-with-uikit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
5 of 46 symbols inside <root> containing 3 symbols[Protecting the User’s Privacy](https://developer.apple.com/documentation/uikit/protecting-the-user-s-privacy)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
6 of 46 symbols inside <root>
App structure
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
7 of 46 symbols inside <root> containing 26 symbols[App and environment](https://developer.apple.com/documentation/uikit/app-and-environment)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
8 of 46 symbols inside <root> containing 15 symbols[Documents, data, and pasteboard](https://developer.apple.com/documentation/uikit/documents-data-and-pasteboard)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
9 of 46 symbols inside <root> containing 11 symbols[Resource management](https://developer.apple.com/documentation/uikit/resource-management)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
10 of 46 symbols inside <root> containing 12 symbols[App extensions](https://developer.apple.com/documentation/uikit/app-extensions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
11 of 46 symbols inside <root> containing 8 symbols[Interprocess communication](https://developer.apple.com/documentation/uikit/interprocess-communication)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
12 of 46 symbols inside <root> containing 27 symbols[Mac Catalyst](https://developer.apple.com/documentation/uikit/mac-catalyst)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
13 of 46 symbols inside <root>
User interface
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
14 of 46 symbols inside <root> containing 70 symbols[Views and controls](https://developer.apple.com/documentation/uikit/views-and-controls)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
15 of 46 symbols inside <root> containing 80 symbols[View controllers](https://developer.apple.com/documentation/uikit/view-controllers)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
16 of 46 symbols inside <root> containing 17 symbols[View layout](https://developer.apple.com/documentation/uikit/view-layout)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
17 of 46 symbols inside <root> containing 26 symbols[Appearance customization](https://developer.apple.com/documentation/uikit/appearance-customization)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
18 of 46 symbols inside <root> containing 15 symbols[Animation and haptics](https://developer.apple.com/documentation/uikit/animation-and-haptics)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
2 of 36 symbols inside -1538151254 [Using responders and the responder chain to handle events](https://developer.apple.com/documentation/uikit/using-responders-and-the-responder-chain-to-handle-events)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
3 of 36 symbols inside -1538151254 containing 81 symbols[UIResponder](https://developer.apple.com/documentation/uikit/uiresponder)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
3 of 36 symbols inside -1538151254 containing 81 symbols[UIResponder](https://developer.apple.com/documentation/uikit/uiresponder)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
4 of 36 symbols inside -1538151254 containing 21 symbols[UIEvent](https://developer.apple.com/documentation/uikit/uievent)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
5 of 36 symbols inside -1538151254 
Touches
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
6 of 36 symbols inside -1538151254 containing 4 symbols[Handling touches in your view](https://developer.apple.com/documentation/uikit/handling-touches-in-your-view)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
7 of 36 symbols inside -1538151254 containing 2 symbols[Handling input from Apple Pencil](https://developer.apple.com/documentation/uikit/handling-input-from-apple-pencil)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
8 of 36 symbols inside -1538151254 containing 2 symbols[Tracking the force of 3D Touch events](https://developer.apple.com/documentation/uikit/tracking-the-force-of-3d-touch-events)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
9 of 36 symbols inside -1538151254 [Illustrating the force, altitude, and azimuth properties of touch input](https://developer.apple.com/documentation/uikit/illustrating-the-force-altitude-and-azimuth-properties-of-touch-input)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
10 of 36 symbols inside -1538151254 [Leveraging touch input for drawing apps](https://developer.apple.com/documentation/uikit/leveraging-touch-input-for-drawing-apps)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
11 of 36 symbols inside -1538151254 containing 32 symbols[UITouch](https://developer.apple.com/documentation/uikit/uitouch)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
12 of 36 symbols inside -1538151254 
Button presses
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
13 of 36 symbols inside -1538151254 containing 15 symbols[UIPress](https://developer.apple.com/documentation/uikit/uipress)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
14 of 36 symbols inside -1538151254 containing 3 symbols[UIPressesEvent](https://developer.apple.com/documentation/uikit/uipressesevent)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
15 of 36 symbols inside -1538151254 
Standard gestures
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
16 of 36 symbols inside -1538151254 containing 7 symbols[Handling UIKit gestures](https://developer.apple.com/documentation/uikit/handling-uikit-gestures)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
17 of 36 symbols inside -1538151254 containing 4 symbols[Coordinating multiple gesture recognizers](https://developer.apple.com/documentation/uikit/coordinating-multiple-gesture-recognizers)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
18 of 36 symbols inside -1538151254 [Adopting hover support for Apple Pencil](https://developer.apple.com/documentation/uikit/adopting-hover-support-for-apple-pencil)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
19 of 36 symbols inside -1538151254 [Supporting gesture interaction in your apps](https://developer.apple.com/documentation/uikit/supporting-gesture-interaction-in-your-apps)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
20 of 36 symbols inside -1538151254 containing 6 symbols[UIHoverGestureRecognizer](https://developer.apple.com/documentation/uikit/uihovergesturerecognizer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
21 of 36 symbols inside -1538151254 containing 5 symbols[UILongPressGestureRecognizer](https://developer.apple.com/documentation/uikit/uilongpressgesturerecognizer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
22 of 36 symbols inside -1538151254 containing 11 symbols[UIPanGestureRecognizer](https://developer.apple.com/documentation/uikit/uipangesturerecognizer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
23 of 36 symbols inside -1538151254 containing 3 symbols[UIPinchGestureRecognizer](https://developer.apple.com/documentation/uikit/uipinchgesturerecognizer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
24 of 36 symbols inside -1538151254 containing 3 symbols[UIRotationGestureRecognizer](https://developer.apple.com/documentation/uikit/uirotationgesturerecognizer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
25 of 36 symbols inside -1538151254 containing 3 symbols[UIScreenEdgePanGestureRecognizer](https://developer.apple.com/documentation/uikit/uiscreenedgepangesturerecognizer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
26 of 36 symbols inside -1538151254 containing 4 symbols[UISwipeGestureRecognizer](https://developer.apple.com/documentation/uikit/uiswipegesturerecognizer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
27 of 36 symbols inside -1538151254 containing 4 symbols[UITapGestureRecognizer](https://developer.apple.com/documentation/uikit/uitapgesturerecognizer)
82 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ UIKit ](https://developer.apple.com/documentation/uikit)
  * [ Touches, presses, and gestures ](https://developer.apple.com/documentation/uikit/touches-presses-and-gestures)
  * [ Leveraging touch input for drawing apps ](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps)
  *     * [ Touches, presses, and gestures ](https://developer.apple.com/documentation/uikit/touches-presses-and-gestures)
    * Leveraging touch input for drawing apps 


Sample Code
# Leveraging touch input for drawing apps
Capture touches as a series of strokes and render them efficiently on a drawing canvas.
[ Download ](https://docs-assets.developer.apple.com/published/72f431f71f59/LeveragingTouchInputForDrawingApps.zip)
iOS 10.0+iPadOS 10.0+Xcode 11.3+
## [Overview](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps#Overview)
This sample project, Speed Sketch, shows how to render a series of strokes a user makes by moving their finger or Apple Pencil across the screen. The project also demonstrates how to:
  * Distinguish between finger and Apple Pencil touches.
  * Improve drawing performance.
  * Enhance the app for Apple Pencil.


### [Distinguish between finger and Apple Pencil touches](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps#Distinguish-between-finger-and-Apple-Pencil-touches)
With Speed Sketch, users can draw by moving their finger or Apple Pencil across the screen, and the system reports the touches to the app. Speed Sketch captures these touches using the custom gesture recognizer, `StrokeGestureRecognizer`.
The stroke gesture recognizer receives each touch event, and appends data from the touches to an array of data samples.
```
override func touchesBegan(_ touches: Set<UITouch>, with event: UIEvent?) {
    if trackedTouch == nil {
        trackedTouch = touches.first
        initialTimestamp = trackedTouch?.timestamp
        collectForce = trackedTouch!.type == .pencil || view?.traitCollection.forceTouchCapability == .available
        if !isForPencil {
            // Give other gestures, such as pan and pinch, a chance by
            // slightly delaying the .began state.
            fingerStartTimer = Timer.scheduledTimer(
                withTimeInterval: cancellationTimeInterval,
                repeats: false,
                block: { [weak self] (timer) in
                    guard let strongSelf = self else { return }
                    if strongSelf.state == .possible {
                        strongSelf.state = .began
                    }
                }
            )
        }
    }
    if append(touches: touches, event: event) {
        if isForPencil {
            state = .began
        }
    }
}


override func touchesMoved(_ touches: Set<UITouch>, with event: UIEvent?) {
    if append(touches: touches, event: event) {
        if state == .began {
            state = .changed
        }
    }
}


override func touchesEnded(_ touches: Set<UITouch>, with event: UIEvent?) {
    if append(touches: touches, event: event) {
        stroke.state = .done
        state = .ended
    }
}


override func touchesCancelled(_ touches: Set<UITouch>, with event: UIEvent?) {
    if append(touches: touches, event: event) {
        stroke.state = .cancelled
        state = .failed
    }
}

```

The [`touchesBegan(_:with:)`](https://developer.apple.com/documentation/uikit/uigesturerecognizer/touchesbegan\(_:with:\)) method sets a timer to give other gesture recognizers, such as pan and pinch, time to handle touches that the user makes with their finger. This behavior is unique to drawing apps such as Speed Sketch that start capturing and drawing a stroke the moment the user touches the screen.
In order to track finger and Apple Pencil touches separately, Speed Sketch uses two instances of `StrokeGestureRecognizer`: one for finger touches and the other to track touches coming from Apple Pencil.
```
self.fingerStrokeRecognizer = setupStrokeGestureRecognizer(isForPencil: false)
self.pencilStrokeRecognizer = setupStrokeGestureRecognizer(isForPencil: true)

```

To simplify the code, the app uses a helper method to create the gesture recognizers.
```
func setupStrokeGestureRecognizer(isForPencil: Bool) -> StrokeGestureRecognizer {
    let recognizer = StrokeGestureRecognizer(target: self, action: #selector(strokeUpdated(_:)))
    recognizer.delegate = self
    recognizer.cancelsTouchesInView = false
    scrollView.addGestureRecognizer(recognizer)
    recognizer.coordinateSpaceView = cgView
    recognizer.isForPencil = isForPencil
    return recognizer
}

```

The gesture recognizer distinguishes between the touch types by setting the [`allowedTouchTypes`](https://developer.apple.com/documentation/uikit/uigesturerecognizer/allowedtouchtypes) property to [`UITouch.TouchType.pencil`](https://developer.apple.com/documentation/uikit/uitouch/touchtype/pencil) when tracking Apple Pencil touches, and to [`UITouch.TouchType.direct`](https://developer.apple.com/documentation/uikit/uitouch/touchtype/direct) when tracking touches from a finger.
```
var isForPencil: Bool = false {
    didSet {
        if isForPencil {
            allowedTouchTypes = [UITouch.TouchType.pencil.rawValue as NSNumber]
        } else {
            allowedTouchTypes = [UITouch.TouchType.direct.rawValue as NSNumber]
        }
    }
}

```

Each time the user draws a stroke on the screen, the stroke gesture recognizer calls the `strokeUpdate(_:)` method. This method checks to see if the recognizer is for Apple Pencil, and if so, puts the app into pencil mode. While the app is in pencil mode, the user can use one finger to pan the drawing canvas. When the app isn’t in pencil mode — that is, when the user is drawing with their finger — the user uses two fingers to pan the drawing canvas.
```
var pencilMode = false {
    didSet {
        if pencilMode {
            scrollView.panGestureRecognizer.minimumNumberOfTouches = 1
            pencilButton.isHidden = false
            if let view = fingerStrokeRecognizer.view {
                view.removeGestureRecognizer(fingerStrokeRecognizer)
            }
        } else {
            scrollView.panGestureRecognizer.minimumNumberOfTouches = 2
            pencilButton.isHidden = true
            if fingerStrokeRecognizer.view == nil {
                scrollView.addGestureRecognizer(fingerStrokeRecognizer)
            }
        }
    }
}

```

### [Improve drawing performance](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps#Improve-drawing-performance)
The stroke gesture recognizer receives touch events from the system. For most apps, the time span between each touch event is enough to handle the gesture. However, users of drawing apps expect greater precision, which requires the app to gather all the touches reported since the last delivered touch event.
To gather the additional touches, Speed Sketch calls the [`coalescedTouches(for:)`](https://developer.apple.com/documentation/uikit/uievent/coalescedtouches\(for:\)) method. This method returns an array of [`UITouch`](https://developer.apple.com/documentation/uikit/uitouch) objects representing the touches received by the system but not delivered in the last event. The additional touches allow Speed Sketch to provide a smoother rendering of the stroke by storing the coalesced touches as part of the stroke’s data sample.
```
if collectsCoalescedTouches {
    if let event = event {
        let coalescedTouches = event.coalescedTouches(for: touchToAppend)!
        let lastIndex = coalescedTouches.count - 1
        for index in 0..<lastIndex {
            saveStrokeSample(stroke: stroke, touch: coalescedTouches[index], view: view, coalesced: true, predicted: false)
        }
        saveStrokeSample(stroke: stroke, touch: coalescedTouches[lastIndex], view: view, coalesced: false, predicted: false)
    }
} else {
    saveStrokeSample(stroke: stroke, touch: touchToAppend, view: view, coalesced: false, predicted: false)
}

```

In addition to coalesced touches, Speed Sketch uses touch data predicted by the system as a way to enhance the perceived accuracy of the app’s drawing capabilities. Speed Sketch retrieves the predicted touches by calling the [`predictedTouches(for:)`](https://developer.apple.com/documentation/uikit/uievent/predictedtouches\(for:\)) method for the event, then saves the touches as part of the data sample for the stroke.
```
if usesPredictedSamples && stroke.state == .active {
    if let predictedTouches = event?.predictedTouches(for: touchToAppend) {
        for touch in predictedTouches {
            saveStrokeSample(stroke: stroke, touch: touch, view: view, coalesced: false, predicted: true)
        }
    }
}

```

The app replaces the predicted touches with actual touches as they become available.
```
override func touchesEstimatedPropertiesUpdated(_ touches: Set<UITouch>) {
    for touch in touches {
        guard let index = touch.estimationUpdateIndex else {
            continue
        }
        if let (stroke, sampleIndex) = outstandingUpdateIndexes[Int(index.intValue)] {
            var sample = stroke.samples[sampleIndex]
            let expectedUpdates = sample.estimatedPropertiesExpectingUpdates
            if expectedUpdates.contains(.force) {
                sample.force = touch.force
                if !touch.estimatedProperties.contains(.force) {
                    // Only remove the estimate flag if the new value isn't estimated as well.
                    sample.estimatedProperties.remove(.force)
                }
            }
            sample.estimatedPropertiesExpectingUpdates = touch.estimatedPropertiesExpectingUpdates
            if touch.estimatedPropertiesExpectingUpdates == [] {
                outstandingUpdateIndexes.removeValue(forKey: sampleIndex)
            }
            stroke.update(sample: sample, at: sampleIndex)
        }
    }
}

```

### [Enhance for Apple Pencil](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps#Enhance-for-Apple-Pencil)
Apple Pencil can sense tilt (altitude), force (pressure), and orientation (azimuth), which drawing apps can use to affect the appearance of strokes. For instance, Speed Sketch uses azimuth to enhance the strokes when using the app’s Calligraphy drawing tool.
```
func drawCalligraphy(in context: CGContext,
                     toSample: StrokeSample,
                     fromSample: StrokeSample,
                     forceAccessBlock: (_ sample: StrokeSample) -> CGFloat) {


    var fromAzimuthUnitVector = Stroke.calligraphyFallbackAzimuthUnitVector
    var toAzimuthUnitVector = Stroke.calligraphyFallbackAzimuthUnitVector


    if fromSample.azimuth != nil {


        if lockedAzimuthUnitVector == nil {
            lockedAzimuthUnitVector = fromSample.azimuthUnitVector
        }
        fromAzimuthUnitVector = fromSample.azimuthUnitVector
        toAzimuthUnitVector = toSample.azimuthUnitVector
        if fromSample.altitude! > azimuthLockAltitudeThreshold {
            fromAzimuthUnitVector = lockedAzimuthUnitVector!
        }
        if toSample.altitude! > azimuthLockAltitudeThreshold {
            toAzimuthUnitVector = lockedAzimuthUnitVector!
        } else {
            lockedAzimuthUnitVector = toAzimuthUnitVector
        }


    }
    // Rotate 90 degrees
    let calligraphyTransform = CGAffineTransform(rotationAngle: CGFloat.pi / 2.0)
    fromAzimuthUnitVector = fromAzimuthUnitVector.applying(calligraphyTransform)
    toAzimuthUnitVector = toAzimuthUnitVector.applying(calligraphyTransform)


    let fromUnitVector = fromAzimuthUnitVector * forceAccessBlock(fromSample)
    let toUnitVector = toAzimuthUnitVector * forceAccessBlock(toSample)


    context.beginPath()
    context.addLines(between: [
        fromSample.location + fromUnitVector,
        toSample.location + toUnitVector,
        toSample.location - toUnitVector,
        fromSample.location - fromUnitVector
        ])
    context.closePath()


    context.drawPath(using: .fillStroke)


}

```

Speed Sketch also displays the altitude and azimuth data as part of the stroke when the user selects the Debug drawing tool.
```
func drawDebugMarkings(in context: CGContext, fromSample: StrokeSample) {


    let isEstimated = fromSample.estimatedProperties.contains(.azimuth)
    guard displayOptions == .debug,
        fromSample.predicted == false,
        fromSample.azimuth != nil,
        (!fromSample.coalesced || isEstimated) else {
            return
    }


    let length = CGFloat(20.0)
    let azimuthUnitVector = fromSample.azimuthUnitVector
    let azimuthTarget = fromSample.location + azimuthUnitVector * length
    let altitudeStart = azimuthTarget + (azimuthUnitVector * (length / -2.0))
    let transformToApply = CGAffineTransform(rotationAngle: fromSample.altitude!)
    let altitudeTarget = altitudeStart + (azimuthUnitVector * (length / 2.0)).applying(transformToApply)


    // Draw altitude as black line coming from the center of the azimuth.
    altitudeSettings(in: context)
    context.beginPath()
    context.move(to: altitudeStart)
    context.addLine(to: altitudeTarget)
    context.strokePath()


    // Draw azimuth as blue (or orange if estimated) line.
    azimuthSettings(in: context)
    if isEstimated {
        context.setStrokeColor(UIColor.orange.cgColor)
    }
    context.beginPath()
    context.move(to: fromSample.location)
    context.addLine(to: azimuthTarget)
    context.strokePath()


}

```

Starting with the second generation Apple Pencil, users can double tap their finger on Apple Pencil to request an action from the app (see [Apple Pencil interactions](https://developer.apple.com/documentation/uikit/apple-pencil-interactions) for more information). When possible, apps should honor the system settings for double-tap actions on Apple Pencil, which include:
  * Switching to the eraser or the last used tool
  * Displaying a color pallet
  * Ignoring double tap


Speed Sketch doesn’t have an eraser tool or color pallet, but it does have different drawing tools: Calligraphy, Ink, and Debug. When the user’s preferred double-tap action is [`UIPencilPreferredAction.switchPrevious`](https://developer.apple.com/documentation/uikit/uipencilpreferredaction/switchprevious) and the user double-taps their finger on Apple Pencil, Speed Sketch switches to the tool last used by the user. The sample app ignores the other preferred actions.
```
func pencilInteractionDidTap(_ interaction: UIPencilInteraction) {
    if UIPencilInteraction.preferredTapAction == .switchPrevious {
        leftRingControl.switchToPreviousTool()
    }
}

```

In order for Speed Sketch to receive the double-tap event, it adds a [`UIPencilInteraction`](https://developer.apple.com/documentation/uikit/uipencilinteraction) object to the canvas view.
```
let pencilInteraction = UIPencilInteraction()
pencilInteraction.delegate = self
view.addInteraction(pencilInteraction)

```

For additional information on supporting touch input in drawing apps and Apple Pencil, watch the WWDC 2016 session video [Leveraging Touch Input on iOS](https://developer.apple.com/videos/play/wwdc2016/220) and the Tech Talks session video [Designing for iPad Pro and Apple Pencil](https://developer.apple.com/videos/play/tech-talks/804/).
## [See Also](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps#see-also)
### [Touches](https://developer.apple.com/documentation/UIKit/leveraging-touch-input-for-drawing-apps#Touches)
[API Reference Handling touches in your view](https://developer.apple.com/documentation/uikit/handling-touches-in-your-view)
Use touch events directly on a view subclass if touch handling is intricately linked to the view’s content.
[API Reference Handling input from Apple Pencil](https://developer.apple.com/documentation/uikit/handling-input-from-apple-pencil)
Learn how to detect and respond to touches from Apple Pencil.
[API Reference Tracking the force of 3D Touch events](https://developer.apple.com/documentation/uikit/tracking-the-force-of-3d-touch-events)
Manipulate your content based on the force of touches.
[Illustrating the force, altitude, and azimuth properties of touch input](https://developer.apple.com/documentation/uikit/illustrating-the-force-altitude-and-azimuth-properties-of-touch-input)
Capture Apple Pencil and touch input in views.
[`class UITouch`](https://developer.apple.com/documentation/uikit/uitouch)
An object representing the location, size, movement, and force of a touch occurring on the screen.
Current page is Leveraging touch input for drawing apps 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2FUIKit%2Fleveraging-touch-input-for-drawing-apps).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
