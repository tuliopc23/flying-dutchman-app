Source: https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session

[ Skip Navigation ](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session)
  * SwiftLanguage:  Swift  Objective-C 
Language: 
    * Swift 
    * [ Objective-C ](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session)


[](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session)
## [ AVFoundation  ](https://developer.apple.com/documentation/avfoundation)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
15 of 54 symbols inside 1551724969 
Capture devices
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
12 of 31 symbols inside <root> containing 26 symbols[Streaming and AirPlay](https://developer.apple.com/documentation/avfoundation/streaming-and-airplay)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
13 of 31 symbols inside <root> containing 11 symbols[Sample buffer playback](https://developer.apple.com/documentation/avfoundation/sample-buffer-playback)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
14 of 31 symbols inside <root>
Capture
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
15 of 31 symbols inside <root> containing 54 symbols[Capture setup](https://developer.apple.com/documentation/avfoundation/capture-setup)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
1 of 54 symbols inside 1551724969 
Essentials
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
2 of 54 symbols inside 1551724969 [Requesting authorization to capture and save media](https://developer.apple.com/documentation/avfoundation/requesting-authorization-to-capture-and-save-media)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
3 of 54 symbols inside 1551724969 
Capture sessions
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
4 of 54 symbols inside 1551724969 [Setting up a capture session](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
5 of 54 symbols inside 1551724969 [Accessing the camera while multitasking on iPad](https://developer.apple.com/documentation/avkit/accessing-the-camera-while-multitasking-on-ipad)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
6 of 54 symbols inside 1551724969 [AVCam: Building a camera app](https://developer.apple.com/documentation/avfoundation/avcam-building-a-camera-app)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
7 of 54 symbols inside 1551724969 [Capturing Cinematic video](https://developer.apple.com/documentation/avfoundation/capturing-cinematic-video)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
8 of 54 symbols inside 1551724969 [AVMultiCamPiP: Capturing from Multiple Cameras](https://developer.apple.com/documentation/avfoundation/avmulticampip-capturing-from-multiple-cameras)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
9 of 54 symbols inside 1551724969 [AVCamBarcode: detecting barcodes and faces](https://developer.apple.com/documentation/avfoundation/avcambarcode-detecting-barcodes-and-faces)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
10 of 54 symbols inside 1551724969 containing 70 symbols[AVCaptureSession](https://developer.apple.com/documentation/avfoundation/avcapturesession)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
11 of 54 symbols inside 1551724969 containing 5 symbols[AVCaptureMultiCamSession](https://developer.apple.com/documentation/avfoundation/avcapturemulticamsession)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
12 of 54 symbols inside 1551724969 containing 3 symbols[AVCaptureInput](https://developer.apple.com/documentation/avfoundation/avcaptureinput)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
13 of 54 symbols inside 1551724969 containing 11 symbols[AVCaptureOutput](https://developer.apple.com/documentation/avfoundation/avcaptureoutput)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
14 of 54 symbols inside 1551724969 containing 43 symbols[AVCaptureConnection](https://developer.apple.com/documentation/avfoundation/avcaptureconnection)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
15 of 54 symbols inside 1551724969 
Capture devices
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
16 of 54 symbols inside 1551724969 [Choosing a capture device](https://developer.apple.com/documentation/avfoundation/choosing-a-capture-device)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
17 of 54 symbols inside 1551724969 [Adopting smart framing in your camera app](https://developer.apple.com/documentation/avfoundation/adopting-smart-framing-in-your-camera-app)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
18 of 54 symbols inside 1551724969 containing 112 symbols[AVCaptureDevice](https://developer.apple.com/documentation/avfoundation/avcapturedevice)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
19 of 54 symbols inside 1551724969 containing 27 symbols[AVCaptureDeviceInput](https://developer.apple.com/documentation/avfoundation/avcapturedeviceinput)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
20 of 54 symbols inside 1551724969 containing 8 symbols[AVContinuityDevice](https://developer.apple.com/documentation/avfoundation/avcontinuitydevice)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
21 of 54 symbols inside 1551724969 containing 13 symbols[AVExternalStorageDevice](https://developer.apple.com/documentation/avfoundation/avexternalstoragedevice)
85 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ AVFoundation ](https://developer.apple.com/documentation/avfoundation)
  * [ Capture setup ](https://developer.apple.com/documentation/avfoundation/capture-setup)
  * [ Setting up a capture session ](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session)
  *     * [ Capture setup ](https://developer.apple.com/documentation/avfoundation/capture-setup)
    * Setting up a capture session 


Article
# Setting up a capture session
Configure input devices, output media, preview views, and basic settings before capturing photos or video.
## [Overview](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session#overview)
An [`AVCaptureSession`](https://developer.apple.com/documentation/avfoundation/avcapturesession) is the basis for all media capture in iOS and macOS. It manages your app’s exclusive access to the OS capture infrastructure and capture devices, as well as the flow of data from input devices to media outputs. How you configure connections between inputs and outputs defines the capabilities of your capture session. For example, the diagram below shows a capture session that can capture both photos and movies and provides a camera preview, using the iPhone back camera and microphone.
![Block diagram of detailed capture session architecture example: separate AVCaptureDeviceInput objects for camera and microphone connect, through AVCaptureConnection objects managed by AVCaptureSession, to AVCapturePhotoOutput, AVCaptureMovieFileOutput, and AVCaptureVideoPreviewLayer.](https://docs-assets.developer.apple.com/published/4b143e0c97baf50234869f35d89f9af0/media-2970419.png)
### [Connect inputs and outputs to the session](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session#Connect-inputs-and-outputs-to-the-session)
All capture sessions need at least one capture input and capture output. Capture inputs ([`AVCaptureInput`](https://developer.apple.com/documentation/avfoundation/avcaptureinput) subclasses) are media sources—typically recording devices like the cameras and microphone built into an iOS device or Mac. Capture outputs ([`AVCaptureOutput`](https://developer.apple.com/documentation/avfoundation/avcaptureoutput) subclasses) use data provided by capture inputs to produce media, like image and movie files.
To use a camera for video input (to capture photos or movies), select an appropriate [`AVCaptureDevice`](https://developer.apple.com/documentation/avfoundation/avcapturedevice), create a corresponding [`AVCaptureDeviceInput`](https://developer.apple.com/documentation/avfoundation/avcapturedeviceinput), and add it to the session:
```
captureSession.beginConfiguration()
let videoDevice = AVCaptureDevice.default(.builtInWideAngleCamera,
                                          for: .video, position: .unspecified)
guard
    let videoDeviceInput = try? AVCaptureDeviceInput(device: videoDevice!),
    captureSession.canAddInput(videoDeviceInput)
    else { return }
captureSession.addInput(videoDeviceInput)

```

Note
iOS offers several other ways to select a camera device. For more information, see [Choosing a capture device](https://developer.apple.com/documentation/avfoundation/choosing-a-capture-device).
Next, add outputs for the kinds of media you plan to capture from the camera you’ve selected. For example, to enable capturing photos, add an [`AVCapturePhotoOutput`](https://developer.apple.com/documentation/avfoundation/avcapturephotooutput) to the session:
```
let photoOutput = AVCapturePhotoOutput()
guard captureSession.canAddOutput(photoOutput) else { return }
captureSession.sessionPreset = .photo
captureSession.addOutput(photoOutput)
captureSession.commitConfiguration()

```

A session can have multiple inputs and outputs. For example:
  * To record both video and audio in a movie, add inputs for both camera and microphone devices.
  * To capture both photos and movies from the same camera, add both [`AVCapturePhotoOutput`](https://developer.apple.com/documentation/avfoundation/avcapturephotooutput) and [`AVCaptureMovieFileOutput`](https://developer.apple.com/documentation/avfoundation/avcapturemoviefileoutput) to your session.


Important
Call [`beginConfiguration()`](https://developer.apple.com/documentation/avfoundation/avcapturesession/beginconfiguration\(\)) before changing a session’s inputs or outputs, and call [`commitConfiguration()`](https://developer.apple.com/documentation/avfoundation/avcapturesession/commitconfiguration\(\)) after making changes.
### [Display a camera preview](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session#Display-a-camera-preview)
It’s important to let the user see input from the camera before choosing to snap a photo or start video recording, as in the viewfinder of a traditional camera. You can provide such a preview by connecting an [`AVCaptureVideoPreviewLayer`](https://developer.apple.com/documentation/avfoundation/avcapturevideopreviewlayer) to your capture session, which displays a live video feed from the camera whenever the session is running.
[`AVCaptureVideoPreviewLayer`](https://developer.apple.com/documentation/avfoundation/avcapturevideopreviewlayer) is a Core Animation layer, so you can display and style it in your interface as you would any other [`CALayer`](https://developer.apple.com/documentation/QuartzCore/CALayer) subclass. The simplest way to add a preview layer to a UIKit app is to define a [`UIView`](https://developer.apple.com/documentation/UIKit/UIView) subclass whose [`layerClass`](https://developer.apple.com/documentation/UIKit/UIView/layerClass) is [`AVCaptureVideoPreviewLayer`](https://developer.apple.com/documentation/avfoundation/avcapturevideopreviewlayer), as shown below.
```
class PreviewView: UIView {
    override class var layerClass: AnyClass {
        return AVCaptureVideoPreviewLayer.self
    }
    
    /// Convenience wrapper to get layer as its statically known type.
    var videoPreviewLayer: AVCaptureVideoPreviewLayer {
        return layer as! AVCaptureVideoPreviewLayer
    }
}

```

Then, to use the preview layer with a capture session, set the layer’s [`session`](https://developer.apple.com/documentation/avfoundation/avcapturevideopreviewlayer/session) property:
```
self.previewView.videoPreviewLayer.session = self.captureSession

```

Note
If your app supports multiple interface orientations, use the preview layer’s [`connection`](https://developer.apple.com/documentation/avfoundation/avcapturevideopreviewlayer/connection) to the capture session to set a [`videoOrientation`](https://developer.apple.com/documentation/avfoundation/avcaptureconnection/videoorientation) matching that of your UI.
### [Run the capture session](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session#Run-the-capture-session)
After you’ve configured inputs, outputs, and previews, call [`startRunning()`](https://developer.apple.com/documentation/avfoundation/avcapturesession/startrunning\(\)) to let data flow from inputs to outputs.
With some capture outputs, running the session is all you need to begin media capture. For example, if your session contains an [`AVCaptureVideoDataOutput`](https://developer.apple.com/documentation/avfoundation/avcapturevideodataoutput), you start receiving delivering video frames as soon as the session is running.
With other capture outputs, you first start the session running, then use the capture output class itself to initiate capture. In a photography app, for example, running the session enables a viewfinder-style preview, but you use the [`AVCapturePhotoOutput`](https://developer.apple.com/documentation/avfoundation/avcapturephotooutput) [`capturePhoto(with:delegate:)`](https://developer.apple.com/documentation/avfoundation/avcapturephotooutput/capturephoto\(with:delegate:\)) method to snap a picture.
## [See Also](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session#see-also)
### [Capture sessions](https://developer.apple.com/documentation/avfoundation/setting-up-a-capture-session#Capture-sessions)
[Accessing the camera while multitasking on iPad](https://developer.apple.com/documentation/AVKit/accessing-the-camera-while-multitasking-on-ipad)
Operate the camera in Split View, Slide Over, Picture in Picture, and Stage Manager modes.
[AVCam: Building a camera app](https://developer.apple.com/documentation/avfoundation/avcam-building-a-camera-app)
Capture photos and record video using the front and rear iPhone and iPad cameras.
[Capturing Cinematic video](https://developer.apple.com/documentation/avfoundation/capturing-cinematic-video)
Capture video with an adjustable depth of field and focus points.
[AVMultiCamPiP: Capturing from Multiple Cameras](https://developer.apple.com/documentation/avfoundation/avmulticampip-capturing-from-multiple-cameras)
Simultaneously record the output from the front and back cameras into a single movie file by using a multi-camera capture session.
[AVCamBarcode: detecting barcodes and faces](https://developer.apple.com/documentation/avfoundation/avcambarcode-detecting-barcodes-and-faces)
Identify machine readable codes or faces by using the camera.
[`class AVCaptureSession`](https://developer.apple.com/documentation/avfoundation/avcapturesession)
An object that configures capture behavior and coordinates the flow of data from input devices to capture outputs.
[`class AVCaptureMultiCamSession`](https://developer.apple.com/documentation/avfoundation/avcapturemulticamsession)
A capture session that supports simultaneous capture from multiple inputs of the same media type.
[`class AVCaptureInput`](https://developer.apple.com/documentation/avfoundation/avcaptureinput)
An abstract superclass for objects that provide input data to a capture session.
[`class AVCaptureOutput`](https://developer.apple.com/documentation/avfoundation/avcaptureoutput)
An abstract superclass for objects that provide media output destinations for a capture session.
[`class AVCaptureConnection`](https://developer.apple.com/documentation/avfoundation/avcaptureconnection)
An object that represents a connection from a capture input to a capture output.
Current page is Setting up a capture session 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Favfoundation%2Fsetting-up-a-capture-session).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
