Source: https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues

[ Skip Navigation ](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues)
  * SwiftLanguage:  Swift  Objective-C 
Language: 
    * Swift 
    * [ Objective-C ](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues)


[](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues)
## [ XCTest  ](https://developer.apple.com/documentation/xctest)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
3 of 30 symbols inside <root> containing 57 symbols[XCTestCase](https://developer.apple.com/documentation/xctest/xctestcase)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
4 of 30 symbols inside <root> containing 15 symbols[XCTest](https://developer.apple.com/documentation/xctest/xctest)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
5 of 30 symbols inside <root>
Test assertions
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
6 of 30 symbols inside <root> containing 5 symbols[Boolean Assertions](https://developer.apple.com/documentation/xctest/boolean-assertions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
7 of 30 symbols inside <root> containing 5 symbols[Nil and Non-Nil Assertions](https://developer.apple.com/documentation/xctest/nil-and-non-nil-assertions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
8 of 30 symbols inside <root> containing 11 symbols[Equality and Inequality Assertions](https://developer.apple.com/documentation/xctest/equality-and-inequality-assertions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
9 of 30 symbols inside <root> containing 5 symbols[Comparable Value Assertions](https://developer.apple.com/documentation/xctest/comparable-value-assertions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
10 of 30 symbols inside <root> containing 2 symbols[Error Assertions](https://developer.apple.com/documentation/xctest/error-assertions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
11 of 30 symbols inside <root> [NSException Assertions](https://developer.apple.com/documentation/xctest/nsexception-assertions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
12 of 30 symbols inside <root> containing 2 symbols[Unconditional Test Failures](https://developer.apple.com/documentation/xctest/unconditional-test-failures)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
13 of 30 symbols inside <root> containing 7 symbols[Expected Failures](https://developer.apple.com/documentation/xctest/expected-failures)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
14 of 30 symbols inside <root> containing 4 symbols[Methods for Skipping Tests](https://developer.apple.com/documentation/xctest/methods-for-skipping-tests)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
15 of 30 symbols inside <root>
Asynchronous tests
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
16 of 30 symbols inside <root> containing 12 symbols[Asynchronous Tests and Expectations](https://developer.apple.com/documentation/xctest/asynchronous-tests-and-expectations)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
17 of 30 symbols inside <root>
UI tests
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
18 of 30 symbols inside <root> [XCUIAutomation](https://developer.apple.com/documentation/xcuiautomation)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
19 of 30 symbols inside <root>
Performance tests
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
20 of 30 symbols inside <root> containing 16 symbols[Performance Tests](https://developer.apple.com/documentation/xctest/performance-tests)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
20 of 30 symbols inside <root> containing 16 symbols[Performance Tests](https://developer.apple.com/documentation/xctest/performance-tests)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
21 of 30 symbols inside <root>
Activities and attachments
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
22 of 30 symbols inside <root> containing 7 symbols[Activities and Attachments](https://developer.apple.com/documentation/xctest/activities-and-attachments)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
1 of 7 symbols inside -1216764902 
Activities
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
2 of 7 symbols inside -1216764902 [Grouping Tests into Substeps with Activities](https://developer.apple.com/documentation/xctest/grouping-tests-into-substeps-with-activities)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
3 of 7 symbols inside -1216764902 containing 2 symbols[XCTContext](https://developer.apple.com/documentation/xctest/xctcontext)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
4 of 7 symbols inside -1216764902 containing 4 symbols[XCTActivity](https://developer.apple.com/documentation/xctest/xctactivity)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
5 of 7 symbols inside -1216764902 
Attachments
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
6 of 7 symbols inside -1216764902 [Adding Attachments to Tests, Activities, and Issues](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
7 of 7 symbols inside -1216764902 containing 28 symbols[XCTAttachment](https://developer.apple.com/documentation/xctest/xctattachment)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
23 of 30 symbols inside <root>
Test execution
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
24 of 30 symbols inside <root> containing 17 symbols[Test Execution and Observation](https://developer.apple.com/documentation/xctest/test-execution-and-observation)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
25 of 30 symbols inside <root>
Deprecated
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
26 of 30 symbols inside <root> containing 16 symbols[Deprecated Symbols](https://developer.apple.com/documentation/xctest/deprecated-symbols)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
27 of 30 symbols inside <root>
Variables
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
V
28 of 30 symbols inside <root> [var XCT_UI_TESTING_AVAILABLE: Int32](https://developer.apple.com/documentation/xctest/xct_ui_testing_available)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
29 of 30 symbols inside <root>
Functions
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
30 of 30 symbols inside <root> [func XCTAssertNoThrow<T>(@autoclosure () throws -> T, @autoclosure () -> String, file: StaticString, line: UInt)](https://developer.apple.com/documentation/xctest/xctassertnothrow\(_:_:file:line:\))
37 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ XCTest ](https://developer.apple.com/documentation/xctest)
  * [ Activities and Attachments ](https://developer.apple.com/documentation/xctest/activities-and-attachments)
  * [ Adding Attachments to Tests, Activities, and Issues ](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues)
  *     * [ Activities and Attachments ](https://developer.apple.com/documentation/xctest/activities-and-attachments)
    * Adding Attachments to Tests, Activities, and Issues 


Article
# Adding Attachments to Tests, Activities, and Issues
Use attachments to store a test’s output data for later analysis.
## [Overview](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues#overview)
Tests often produce output such as files, images, screenshots, and data during their execution. You can store this test output for later analysis by wrapping it in an [`XCTAttachment`](https://developer.apple.com/documentation/xctest/xctattachment) instance and adding it to the current test, activity, or issue. You can then view these attachments within Xcode’s test results browser alongside the test, activity, or issue that created them.
![A screenshot of the output of a UI test in Xcode’s test results browser. A contextual menu shows an option to view a Quick Look of a screenshot attachment.](https://docs-assets.developer.apple.com/published/8c704d4950733f86624db25ac36ac90f/media-2902802%402x.png)
[`XCTAttachment`](https://developer.apple.com/documentation/xctest/xctattachment) provides several convenience initializers to create attachments for common data types, such as images, screenshots, files, folders, strings, and custom objects, that conform to [`NSSecureCoding`](https://developer.apple.com/documentation/Foundation/NSSecureCoding) or that you can encode as a property list. Alternatively, you can attach custom test output by creating an attachment from raw data in memory.
You associate an attachment with a test by calling the [`add(_:)`](https://developer.apple.com/documentation/xctest/xctactivity/add\(_:\)) method on an instance of a type that conforms to the [`XCTActivity`](https://developer.apple.com/documentation/xctest/xctactivity) protocol. [`XCTestCase`](https://developer.apple.com/documentation/xctest/xctestcase) automatically conforms to [`XCTActivity`](https://developer.apple.com/documentation/xctest/xctactivity) so you can add an attachment to the current test by calling [`add(_:)`](https://developer.apple.com/documentation/xctest/xctactivity/add\(_:\)) from within any test method.
Listing 1. Attaching a screenshot of an app’s first window to the current test.
```
class MainWindowScreenshotTests: XCTestCase {
    func testTakeScreenshotOfMainWindow() {
        let app = XCUIApplication()
        app.launch()
        let screenshot = app.windows.firstMatch.screenshot()
        let attachment = XCTAttachment(screenshot: screenshot)
        attachment.lifetime = .keepAlways
        add(attachment)
    }
}

```

Alternatively, you can create and run a custom activity by calling the [`XCTContext`](https://developer.apple.com/documentation/xctest/xctcontext) [`runActivityNamed:block:`](https://developer.apple.com/documentation/xctest/xctcontext/runactivitynamed:block:) class method from anywhere in your testing code. This method runs a user-provided block of test code, passing an [`XCTActivity`](https://developer.apple.com/documentation/xctest/xctactivity) instance to the block. Call [`add(_:)`](https://developer.apple.com/documentation/xctest/xctactivity/add\(_:\)) on this [`XCTActivity`](https://developer.apple.com/documentation/xctest/xctactivity) instance to add an attachment to the activity instead of the overall test.
Every attachment you create has a [`uniformTypeIdentifier`](https://developer.apple.com/documentation/xctest/xctattachment/uniformtypeidentifier) property containing a Uniform Type Identifier (UTI) that identifies the type of content in the attachment. Many of [`XCTAttachment`](https://developer.apple.com/documentation/xctest/xctattachment)’s convenience initializers determine an appropriate UTI to use from their provided content. Alternatively, you can provide a manual UTI value to represent a custom data format to use in your app.
Listing 2. Adding attachments in response to a background data download
```
func testDownloadAndAttachWebData() {
    
    // Create an expectation for a background download task.
    let expectation = XCTestExpectation(description: "Download apple.com home page")
    
    // Create a URL for a web page to download.
    let url = URL(string: "https://apple.com")!
    
    // Create a background task to download the web page.
    let dataTask = URLSession.shared.dataTask(with: url) { (data, urlResponse, error) in
        
        // Process the download task's response, adding some of its output as attachments.
        
        if let error = error {
            
            XCTFail("Data failed to download with an error: \(error.localizedDescription).")
            
        } else if let httpURLResponse = urlResponse as? HTTPURLResponse, httpURLResponse.statusCode != 200 {
            
            // Attach the response's header fields as an XML property list.              
            let headers = XCTAttachment(plistObject: httpURLResponse.allHeaderFields)
            headers.name = "Headers"
                
            let description = "Unexpected status code: \(httpURLResponse.statusCode)."
            var issue = XCTIssue(type: .assertionFailure, compactDescription: description)
            issue.add(headers)
            self.record(issue)
            
        } else if let data = data {
            
            // Attach the retrieved HTML data with an appropriate UTI.
            let html = XCTAttachment(data: data, uniformTypeIdentifier: "public.html")
            html.name = "HTML"
            // Keep the HTML attachment even when the test succeeds.
            html.lifetime = .keepAlways
            self.add(html)
            
        }
        
        // Fulfill the expectation to indicate that the background task has finished.
        expectation.fulfill()
        
    }
    
    // Start the download task.
    dataTask.resume()
    
    // Wait until the expectation is fulfilled, with a timeout of 10 seconds.
    wait(for: [expectation], timeout: 10.0)
    
}

```

Listing 2 performs an integration test of a web page download. The download occurs on a background thread.
The code above produces one of three outcomes from the results of the download:
  * If the data task returns an error, the test fails and logs the error’s description as part of the failure.
  * If the data task succeeds, but has an HTTP response status code of anything other than `200 OK`, the sample code adds the response’s header fields to a new `XCTIssue` as an XML property list attachment to assist with debugging the problem.
  * If the data task succeeds and retrieves some data, the sample code adds the retrieved data to the test as an attachment with a UTI of `public.html`, enabling Xcode to provide an appropriate Quick Look for the data within the Xcode test results browser. The sample code sets the attachment’s lifetime property to [`XCTAttachment.Lifetime.keepAlways`](https://developer.apple.com/documentation/xctest/xctattachment/lifetime-swift.enum/keepalways) to store the HTML data even though the test succeeds.


See `Testing Asynchronous Operations with Expectations` for more information.
### [Attachment Lifetime](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues#Attachment-Lifetime)
By default, when the test passes successfully, it discards the test’s attachments to save storage. To persist an attachment even when its test passes, set the attachment’s [`lifetime`](https://developer.apple.com/documentation/xctest/xctattachment/lifetime-swift.property) property to [`XCTAttachment.Lifetime.keepAlways`](https://developer.apple.com/documentation/xctest/xctattachment/lifetime-swift.enum/keepalways) rather than the default value of [`XCTAttachment.Lifetime.deleteOnSuccess`](https://developer.apple.com/documentation/xctest/xctattachment/lifetime-swift.enum/deleteonsuccess). Alternatively, change the default lifetime for an entire test scheme by deselecting the “Attachments: Delete when each test succeeds” option in the Options tab of the scheme’s Test scheme action.
![A screenshot of Xcode’s Scheme Editor showing the “Delete when each test succeeds” attachments option in the Options tab of the scheme’s Test scheme action.](https://docs-assets.developer.apple.com/published/cf13056c108c4aabbb248e2377bbfdc1/media-2902800%402x.png)
## [See Also](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues#see-also)
### [Attachments](https://developer.apple.com/documentation/xctest/adding-attachments-to-tests-activities-and-issues#Attachments)
[`class XCTAttachment`](https://developer.apple.com/documentation/xctest/xctattachment)
Data from a test method’s execution, such as a file, image, screenshot, data blob, or ZIP file.
Current page is Adding Attachments to Tests, Activities, and Issues 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fxctest%2Fadding-attachments-to-tests-activities-and-issues).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
