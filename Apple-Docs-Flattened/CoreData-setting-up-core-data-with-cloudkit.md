Source: https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit

[ Skip Navigation ](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit)
  * SwiftLanguage:  Swift  Objective-C 
Language: 
    * Swift 
    * [ Objective-C ](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit)


[](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit)
## [ Core Data  ](https://developer.apple.com/documentation/coredata)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
26 of 37 symbols inside <root> containing 8 symbols[Persistent history](https://developer.apple.com/documentation/coredata/persistent-history)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
13 of 37 symbols inside <root> containing 3 symbols[NSAsynchronousFetchResult](https://developer.apple.com/documentation/coredata/nsasynchronousfetchresult)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
14 of 37 symbols inside <root> containing 25 symbols[NSFetchedResultsController](https://developer.apple.com/documentation/coredata/nsfetchedresultscontroller)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
15 of 37 symbols inside <root>
SwiftData migration and coexistence
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
16 of 37 symbols inside <root> [Adopting SwiftData for a Core Data app](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
17 of 37 symbols inside <root>
CloudKit mirroring
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
18 of 37 symbols inside <root> containing 5 symbols[Mirroring a Core Data store with CloudKit](https://developer.apple.com/documentation/coredata/mirroring-a-core-data-store-with-cloudkit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
1 of 5 symbols inside -1782755344 
Configuring CloudKit Mirroring
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
2 of 5 symbols inside -1782755344 [Setting Up Core Data with CloudKit](https://developer.apple.com/documentation/coredata/setting-up-core-data-with-cloudkit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
3 of 5 symbols inside -1782755344 [Creating a Core Data Model for CloudKit](https://developer.apple.com/documentation/coredata/creating-a-core-data-model-for-cloudkit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
4 of 5 symbols inside -1782755344 [Syncing a Core Data Store with CloudKit](https://developer.apple.com/documentation/coredata/syncing-a-core-data-store-with-cloudkit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
5 of 5 symbols inside -1782755344 [Reading CloudKit Records for Core Data](https://developer.apple.com/documentation/coredata/reading-cloudkit-records-for-core-data)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
19 of 37 symbols inside <root> [Synchronizing a local store to the cloud](https://developer.apple.com/documentation/coredata/synchronizing-a-local-store-to-the-cloud)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
20 of 37 symbols inside <root> containing 16 symbols[NSPersistentCloudKitContainer](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontainer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
21 of 37 symbols inside <root> containing 4 symbols[NSPersistentCloudKitContainerOptions](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontaineroptions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
22 of 37 symbols inside <root> [Sharing Core Data objects between iCloud users](https://developer.apple.com/documentation/coredata/sharing-core-data-objects-between-icloud-users)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
23 of 37 symbols inside <root>
Change processing
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
24 of 37 symbols inside <root> [Accessing data when the store changes](https://developer.apple.com/documentation/coredata/accessing-data-when-the-store-changes)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
25 of 37 symbols inside <root> [Consuming relevant store changes](https://developer.apple.com/documentation/coredata/consuming-relevant-store-changes)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
26 of 37 symbols inside <root> containing 8 symbols[Persistent history](https://developer.apple.com/documentation/coredata/persistent-history)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
27 of 37 symbols inside <root>
Background tasks
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
28 of 37 symbols inside <root> [Using Core Data in the background](https://developer.apple.com/documentation/coredata/using-core-data-in-the-background)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
29 of 37 symbols inside <root> [Loading and displaying a large data feed](https://developer.apple.com/documentation/swiftui/loading-and-displaying-a-large-data-feed)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
30 of 37 symbols inside <root> containing 5 symbols[Conflict resolution](https://developer.apple.com/documentation/coredata/conflict-resolution)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
31 of 37 symbols inside <root> containing 9 symbols[Batch processing](https://developer.apple.com/documentation/coredata/batch-processing)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
32 of 37 symbols inside <root>
Data model migration
42 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ Core Data ](https://developer.apple.com/documentation/coredata)
  * [ Mirroring a Core Data store with CloudKit ](https://developer.apple.com/documentation/coredata/mirroring-a-core-data-store-with-cloudkit)
  * [ Setting Up Core Data with CloudKit ](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit)
  *     * [ Mirroring a Core Data store with CloudKit ](https://developer.apple.com/documentation/coredata/mirroring-a-core-data-store-with-cloudkit)
    * Setting Up Core Data with CloudKit 


Article
# Setting Up Core Data with CloudKit
Set up the classes and capabilities that sync your store to CloudKit.
## [Overview](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#overview)
To sync your Core Data store to CloudKit, you enable the CloudKit capability for your app. You also set up the Core Data stack with a persistent container that is capable of managing one or more local persistent stores that are backed by a CloudKit private database.
### [Configure a new Xcode project](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#Configure-a-new-Xcode-project)
When you create a new project, you specify whether you want to add support for Core Data with CloudKit directly from the project setup interface. The resulting project contains an [`NSPersistentCloudKitContainer`](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontainer). Once you enable CloudKit in your project, you use this container to manage one or more local stores that are backed with a CloudKit database.
  1. Choose File > New > Project to create a new project.
  2. Select a project template to use as the starting point for your project, and click Next.
  3. Select the Core Data option for Storage.
  4. Select the Host in Cloudkit checkbox.
  5. Enter any other project details and click Next.
  6. Specify a location for your project and click Create.


![Screenshot showing the new project creation dialog with the Core Data Storage option and Host in CloudKit checkbox selected.](https://docs-assets.developer.apple.com/published/f748f77f7568bed1705e93b795580c6d/media-4434183%402x.png)
Not all project templates support Core Data. If the template you want to use doesn’t currently support Core Data, add Core Data to the project as described in [Setting up a Core Data stack](https://developer.apple.com/documentation/coredata/setting-up-a-core-data-stack). Then add Core Data with CloudKit as described in [Update an existing Xcode project](https://developer.apple.com/documentation/coredata/setting-up-core-data-with-cloudkit#Update-an-existing-Xcode-project).
### [Enable iCloud](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#Enable-iCloud)
Core Data with CloudKit requires specific entitlements for your app to communicate with the server. If you have created a new template following the steps above, this will be done for you. For an existing app, begin by adding the iCloud capability to your Xcode project.
  1. In Project Settings, select the Signing & Capabilities tab.
  2. Make sure that “Automatically manage signing” is selected.
  3. Specify your development team.
  4. Click the + Capability button, then do a search for iCloud in the Add Capability editor and select that capability.


![Screenshot showing the locations of the Add Capability button, Automatically manage signing checkbox, and Team dropdown in the Signing & Capabilities tab in Project Settings.](https://docs-assets.developer.apple.com/published/52078c8b70403835bbd18631b9101788/media-4436809%402x.png)
An iCloud section appears on your app’s Signing & Capabilities page.
### [Enable CloudKit and push notifications](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#Enable-CloudKit-and-push-notifications)
Core Data with CloudKit uses the CloudKit service to access your team’s containers. To enable CloudKit, configure the iCloud capability.
  1. In Project Settings, select the Signing & Capabilities tab and find the iCloud section.
  2. Select the CloudKit checkbox. This selection also adds push notifications that notify your app when remote content changes.
  3. Under Containers, add or select a container. For more information about working with CloudKit containers and setting up profiles, see [Enabling CloudKit in Your App](https://developer.apple.com/library/archive/documentation/DataManagement/Conceptual/CloudKitQuickStart/EnablingiCloudandConfiguringCloudKit/EnablingiCloudandConfiguringCloudKit.html#//apple_ref/doc/uid/TP40014987-CH2).


![Screenshot showing the iCloud section of the Signing & Capabilities tab with CloudKit enabled.](https://docs-assets.developer.apple.com/published/06abe307359943cc63cd1d8c73640f81/media-4436808%402x.png)
Xcode checks that your development team supports the Push Notification and iCloud capabilities, then registers your app’s bundle identifier and manages provisioning profiles.
### [Enable Remote notifications in the background](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#Enable-Remote-notifications-in-the-background)
For CloudKit to silently notify your app when new content is available, without presenting a user notification such as an alert, sound, or badge, you need to enable the Remote notifications Background Mode.
  1. In Project Settings, select the Signing & Capabilities tab.
  2. Click the + Capability button, then do a search for Background Modes in the Add Capability editor and select that capability.
  3. Select the “Remote notifications” checkbox.


![Screenshot showing the Background Modes section of the Signing & Capabilities tab with the Remote notifications checkbox selected.](https://docs-assets.developer.apple.com/published/ada6c9909dace104f96da43d22dc037d/media-4436810%402x.png)
For more information about silent notifications, see [Pushing background updates to your App](https://developer.apple.com/documentation/UserNotifications/pushing-background-updates-to-your-app).
### [Update an existing Xcode project](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#Update-an-existing-Xcode-project)
If you want to add Core Data with CloudKit to an app that already uses Core Data, you need to modify both your project’s configuration and some of its code.
First, enable iCloud, CloudKit, Push notifications, and Remote notifications in the background as described in the preceding sections. Then, replace your persistent container with an instance of [`NSPersistentCloudKitContainer`](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontainer).
For example, if you created a project from the Multiplatform App template, with the Use Core Data checkbox selected, the following code appeared in the `PersistenceController`:
```
init(inMemory: Bool = false) {
    container = NSPersistentContainer(name: "Earthquakes")
    if inMemory {
        container.persistentStoreDescriptions.first!.url = URL(fileURLWithPath: "/dev/null")
    }
    container.loadPersistentStores(completionHandler: { (storeDescription, error) in
        if let error = error as NSError? {
            fatalError("Unresolved error \(error), \(error.userInfo)")
        }
    })
    container.viewContext.automaticallyMergesChangesFromParent = true
}

```

[`NSPersistentContainer`](https://developer.apple.com/documentation/coredata/nspersistentcontainer) supports only local persistent stores. To add the ability to sync a local store to a CloudKit database, replace [`NSPersistentContainer`](https://developer.apple.com/documentation/coredata/nspersistentcontainer) with the subclass [`NSPersistentCloudKitContainer`](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontainer).
```
    let container = NSPersistentCloudKitContainer(name: "Earthquakes")

```

### [Manage multiple stores](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#Manage-multiple-stores)
You might need to mirror a subset of your data using CloudKit, while keeping other data completely local. You can add configurations to your model to organize your data in separate stores, then choose which stores to sync to CloudKit.
  1. Open your project’s `.xcdatamodeld` file.
  2. Choose Editor > Add Configuration.
  3. Drag each entity into a configuration.
  4. Select a configuration that you want to sync to CloudKit, then select the “Used with CloudKit” checkbox in the data model editor. Repeat for each configuration that you want to sync.


![Screenshot showing the .xcdatamodeld file with the Configuration list at left containing Default, Cache, Cloud, and Local configurations. The Cloud configuration is selected and its “Used with CloudKit” checkbox is selected in the Data Model inspector.](https://docs-assets.developer.apple.com/published/ecf5d61fd34f3d17ac184ba7bccf9bf1/media-4445965%402x.png)
For an app without configurations, [`NSPersistentCloudKitContainer`](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontainer) matches the first store description with the first CloudKit container identifier in the entitlements.
For an app with configurations, you need to tell it which CloudKit container, if any, to use with each store. For each of your configurations, make the following changes to your container setup:
  1. Create an [`NSPersistentStoreDescription`](https://developer.apple.com/documentation/coredata/nspersistentstoredescription).
  2. Set the store description’s configuration.
  3. If this configuration needs to synchronize to CloudKit, set the store description’s [`cloudKitContainerOptions`](https://developer.apple.com/documentation/coredata/nspersistentstoredescription/cloudkitcontaineroptions) to an instance of [`NSPersistentCloudKitContainerOptions`](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontaineroptions). Provide the container identifier of your CloudKit container in the initializer.
  4. Add the store description to the persistent container before loading the store.


The following example code creates two store descriptions: one for the “Local” configuration, and one for the “Cloud” configuration. It then sets the cloud store description’s [`cloudKitContainerOptions`](https://developer.apple.com/documentation/coredata/nspersistentstoredescription/cloudkitcontaineroptions) to match the store with its CloudKit container. Finally, it updates the container’s list of persistent store descriptions to include all local and cloud-backed store descriptions, and loads both stores.
```
lazy var persistentContainer: NSPersistentCloudKitContainer = {
    let container = NSPersistentCloudKitContainer(name: "Earthquakes")
    
    // Create a store description for a local store.
    let localStoreLocation = URL(fileURLWithPath: "/path/to/local.store")
    let localStoreDescription =
        NSPersistentStoreDescription(url: localStoreLocation)
    localStoreDescription.configuration = "Local"
    
    // Create a store description for a CloudKit-backed local store.
    let cloudStoreLocation = URL(fileURLWithPath: "/path/to/cloud.store")
    let cloudStoreDescription =
        NSPersistentStoreDescription(url: cloudStoreLocation)
    cloudStoreDescription.configuration = "Cloud"


    // Set the container options on the cloud store.
    cloudStoreDescription.cloudKitContainerOptions = 
        NSPersistentCloudKitContainerOptions(
            containerIdentifier: "com.my.container")
    
    // Update the container's list of store descriptions.
    container.persistentStoreDescriptions = [
        cloudStoreDescription,
        localStoreDescription
    ]
    
    // Load both stores.
    container.loadPersistentStores { storeDescription, error in
        guard error == nil else {
            fatalError("Could not load persistent stores. \(error!)")
        }
    }
    
    return container
}()

```

## [See Also](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#see-also)
### [Configuring CloudKit Mirroring](https://developer.apple.com/documentation/CoreData/setting-up-core-data-with-cloudkit#Configuring-CloudKit-Mirroring)
[Creating a Core Data Model for CloudKit](https://developer.apple.com/documentation/coredata/creating-a-core-data-model-for-cloudkit)
Design a CloudKit-compatible data model and initialize your CloudKit schema.
[Syncing a Core Data Store with CloudKit](https://developer.apple.com/documentation/coredata/syncing-a-core-data-store-with-cloudkit)
Synchronize objects between devices, and handle store changes in the user interface.
[Reading CloudKit Records for Core Data](https://developer.apple.com/documentation/coredata/reading-cloudkit-records-for-core-data)
Access CloudKit records created from Core Data managed objects.
Current page is Setting Up Core Data with CloudKit 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2FCoreData%2Fsetting-up-core-data-with-cloudkit).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
