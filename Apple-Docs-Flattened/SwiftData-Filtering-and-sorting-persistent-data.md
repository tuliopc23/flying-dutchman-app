Source: https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data

[ Skip Navigation ](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data)
  * SwiftLanguage: Swift


[](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data)
## [ SwiftData  ](https://developer.apple.com/documentation/swiftdata)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
36 of 56 symbols inside <root> containing 8 symbols[HistoryProviding](https://developer.apple.com/documentation/swiftdata/historyproviding)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
18 of 56 symbols inside <root> containing 47 symbols[ModelContext](https://developer.apple.com/documentation/swiftdata/modelcontext)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
19 of 56 symbols inside <root> [Fetching and filtering time-based model changes](https://developer.apple.com/documentation/swiftdata/fetching-and-filtering-time-based-model-changes)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
20 of 56 symbols inside <root> containing 7 symbols[HistoryDescriptor](https://developer.apple.com/documentation/swiftdata/historydescriptor)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
21 of 56 symbols inside <root> [Deleting persistent data from your app](https://developer.apple.com/documentation/swiftdata/deleting-persistent-data-from-your-app)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
22 of 56 symbols inside <root> [Reverting data changes using the undo manager](https://developer.apple.com/documentation/swiftdata/reverting-data-changes-using-the-undo-manager)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
23 of 56 symbols inside <root> [Syncing model data across a person’s devices](https://developer.apple.com/documentation/swiftdata/syncing-model-data-across-a-persons-devices)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
24 of 56 symbols inside <root> containing 7 symbols[Concurrency support](https://developer.apple.com/documentation/swiftdata/concurrencysupport)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
25 of 56 symbols inside <root>
Model fetch
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
26 of 56 symbols inside <root> [Filtering and sorting persistent data](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
#
27 of 56 symbols inside <root> [macro Query()](https://developer.apple.com/documentation/swiftdata/query\(\))
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
28 of 56 symbols inside <root> containing 13 symbols[Additional query macros](https://developer.apple.com/documentation/swiftdata/additionalquerymacros)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
29 of 56 symbols inside <root> containing 14 symbols[Query](https://developer.apple.com/documentation/swiftdata/query)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
30 of 56 symbols inside <root> containing 13 symbols[FetchDescriptor](https://developer.apple.com/documentation/swiftdata/fetchdescriptor)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
31 of 56 symbols inside <root>
Model storage
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
32 of 56 symbols inside <root> [Maintaining a local copy of server data](https://developer.apple.com/documentation/swiftdata/maintaining-a-local-copy-of-server-data)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
33 of 56 symbols inside <root> containing 6 symbols[DefaultStore](https://developer.apple.com/documentation/swiftdata/defaultstore)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
34 of 56 symbols inside <root> containing 28 symbols[DataStore](https://developer.apple.com/documentation/swiftdata/datastore)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
35 of 56 symbols inside <root> containing 3 symbols[DataStoreBatching](https://developer.apple.com/documentation/swiftdata/datastorebatching)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
36 of 56 symbols inside <root> containing 8 symbols[HistoryProviding](https://developer.apple.com/documentation/swiftdata/historyproviding)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
37 of 56 symbols inside <root> [Building a document-based app using SwiftData](https://developer.apple.com/documentation/swiftui/building-a-document-based-app-using-swiftdata)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
S
38 of 56 symbols inside <root> [ModelDocument](https://developer.apple.com/documentation/swiftdata/modeldocument)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
39 of 56 symbols inside <root>
History life cycle
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
E
40 of 56 symbols inside <root> containing 6 symbols[HistoryChange](https://developer.apple.com/documentation/swiftdata/historychange)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
41 of 56 symbols inside <root> containing 9 symbols[HistoryDelete](https://developer.apple.com/documentation/swiftdata/historydelete)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
42 of 56 symbols inside <root> containing 8 symbols[HistoryInsert](https://developer.apple.com/documentation/swiftdata/historyinsert)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
rP
43 of 56 symbols inside <root> containing 4 symbols[HistoryToken](https://developer.apple.com/documentation/swiftdata/historytoken)
56 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ SwiftData ](https://developer.apple.com/documentation/swiftdata)
  * [ Filtering and sorting persistent data ](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data)
  *     * Filtering and sorting persistent data 


Sample Code
# Filtering and sorting persistent data
Manage data store presentation using predicates and dynamic queries.
[ Download ](https://docs-assets.developer.apple.com/published/5e964e0daa88/SwiftDataLocalDataCacheSample.zip)
iOS 17.0+iPadOS 17.0+macOS 14.0+Xcode 15.0+
## [Overview](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#Overview)
This sample app displays a list of earthquakes, showing the time, location, and size of each earthquake. To help people visualize the list, the app also pinpoints each earthquake on a map. You can select an earthquake in the list to highlight it on the map.
The app uses SwiftData to store and manage the earthquake data, and relies on dynamic queries to present the data in different ways. For example, people can select which day’s earthquakes to display, sort the earthquakes by magnitude or time in forward or reverse order, and filter by location name.
![A screenshot of the sample app running on an iPhone 14 Pro. The app's list view shows a list of earthquakes. Text in the bottom toolbar on the left indicates that there are 145 earthquakes in the list out of 9,738 total stored earthquakes. A date picker in the bottom toolbar on the right is activate and displays a calendar for selecting a date. The date August 21, 2023 is currently highlighted in the date picker's calendar. The top toolbar has a sort button and a trash button.](https://docs-assets.developer.apple.com/published/0b52d2772645d45035621de11df2e387/Filtering-and-sorting-persistent-data-1%402x.png)
![A screenshot of the sample app running on an iPhone 14 Pro. The app's list view shows a list of earthquakes. Text in the bottom toolbar on the left indicates that there are 145 earthquakes in the list out of 9,738 total stored earthquakes. A date picker in the bottom toolbar on the right is inactivate and displays the date August 21, 2023. A sort button in the top toolbar on the right is selected and displays a popover with the items Forward, Reverse, Time, and Magnitude. The items Reverse and Time both have a checkmark. The top toolbar also has a trash button.](https://docs-assets.developer.apple.com/published/2a6c4e748fb2209640b9da88793898b0/Filtering-and-sorting-persistent-data-2%402x.png)
![A screenshot of the sample app running on an iPhone 14 Pro. The app's list view shows a list of 3 earthquakes. Text in the bottom toolbar on the left indicates that there are three earthquakes in the list out of 9,738 total stored earthquakes. A date picker in the bottom toolbar on the right is inactivate and displays the date August 21, 2023. A search field appears at the top of the display and contains the text Nevada. All of the items visible in the list have the text Nevada in their location names.](https://docs-assets.developer.apple.com/published/4fc3986c9459e39aa5ac0d470c4fcef7/Filtering-and-sorting-persistent-data-3%402x.png)
Note
To learn how the app retrieves and stores earthquake data, see [Maintaining a local copy of server data](https://developer.apple.com/documentation/swiftdata/maintaining-a-local-copy-of-server-data).
### [Read the entire collection with a simple query](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#Read-the-entire-collection-with-a-simple-query)
The app’s `ContentView` fetches a complete list of earthquakes by applying the [`Query`](https://developer.apple.com/documentation/swiftdata/query) macro to its `quakes` property:
```
@Query private var quakes: [Quake]

```

The query macro injects code that keeps the array of earthquake instances synchronized with items in the data store. The view uses this list of earthquakes to configure the navigation bar based on the selected earthquake. For example, it sets the title and subtitle in macOS:
```
.navigationTitle(quakes[selectedId]?.location.name ?? "Earthquakes")
.navigationSubtitle(quakes[selectedId]?.fullDate ?? "")

```

The above code relies on a subscript method that the app defines in an extension of [`Array`](https://developer.apple.com/documentation/Swift/Array):
```
extension Array where Element: Quake {
    subscript(id: Quake.ID?) -> Quake? {
        first { $0.id == id }
    }
}

```

The subscript definition relies on the fact that model objects — types attributed with the [`Model()`](https://developer.apple.com/documentation/swiftdata/model\(\)) macro, like `Quake` — automatically conform to the [`Identifiable`](https://developer.apple.com/documentation/Swift/Identifiable) protocol, which means that each earthquake instance has a unique `id` parameter. When someone selects an earthquake in the list or map view, the app sets `selectedId` to the selected earthquake’s identifier.
### [Add a sort parameter to order data](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#Add-a-sort-parameter-to-order-data)
The map view draws circles to represent quakes at particular locations, using a size for the circle that corresponds to the earthquake’s magnitude. To keep the circles visible when several overlap, `MapView` sorts its query by magnitude so that the map draws larger circles behind smaller ones.
![A screenshot of the sample app running on an iPhone 14 Pro.](https://docs-assets.developer.apple.com/published/d4aefb890b159499d09e002f8d7d794b/Filtering-and-sorting-persistent-data-4%402x.png)
It introduces the sorting by adding parameters to the query macro:
```
@Query(sort: \Quake.magnitude, order: .reverse)
private var quakes: [Quake]

```

The output of this query drives the generation of the map content builder’s `QuakeMarker` instances, and always appears in the desired order:
```
Map(selection: $selectedIdMap) {
    ForEach(quakes) { quake in
        QuakeMarker(
            quake: quake,
            selected: quake.id == selectedId)
    }
}

```

Note
The app binds `selectedIdMap` to the map’s selection input and manually synchronizes this with the main `selectedId` value that’s used elsewhere in code. Keeping separate selection values enables the app to detect changes driven from the map and then scroll the list to match.
### [Define a filter using a predicate](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#Define-a-filter-using-a-predicate)
To ensure that the app’s interface remains approachable, the app limits how many earthquakes it displays based on:
  * **A date** — To avoid overwhelming the map with too many markers, the app displays only one day’s worth of earthquakes at a time. People can choose which day to view.
  * **A location name** — To enable people to focus on specific earthquakes, people can enter text in a search field that the app matches against earthquake location names.


To implement this filtering, the app defines a static method that returns a [`Predicate`](https://developer.apple.com/documentation/Foundation/Predicate) that takes into account both a search date and search text:
```
static func predicate(
    searchText: String,
    searchDate: Date
) -> Predicate<Quake> {
    let calendar = Calendar.autoupdatingCurrent
    let start = calendar.startOfDay(for: searchDate)
    let end = calendar.date(byAdding: .init(day: 1), to: start) ?? start


    return #Predicate<Quake> { quake in
        (searchText.isEmpty || quake.location.name.contains(searchText))
        &&
        (quake.time > start && quake.time < end)
    }
}

```

The app applies this predicate to the queries it creates dynamically, as the next section describes. By defining the predicate once in a central location, queries in multiple views can use it. This makes it easy to synchronize related views, like the list and map views, when the views have distinct queries.
### [Update a query dynamically](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#Update-a-query-dynamically)
When someone selects a new date or changes the search text, the app needs to update the query to match. The map view achieves this by providing an initializer with `searchDate` and `searchText` inputs, and rebuilding the stored query using those values:
```
init(
    selectedId: Binding<Quake.ID?>,
    selectedIdMap: Binding<Quake.ID?>,
    searchDate: Date = .now,
    searchText: String = ""
) {
    _selectedId = selectedId
    _selectedIdMap = selectedIdMap


    _quakes = Query(
        filter: Quake.predicate(
            searchText: searchText,
            searchDate: searchDate),
        sort: \.magnitude,
        order: .reverse
    )
}

```

Because these values are inputs to the view’s initializer, SwiftUI reevaluates the initializer to produce a new query whenever either value changes. This in turn updates the appearance of the view.
The earthquake list view does something similar, although in this case it takes sort configuration inputs as well:
```
init(
    selectedId: Binding<Quake.ID?>,
    selectedIdMap: Binding<Quake.ID?>,
    
    searchText: String = "",
    searchDate: Date = .now,
    sortParameter: SortParameter = .time,
    sortOrder: SortOrder = .reverse
) {
    _selectedId = selectedId
    _selectedIdMap = selectedIdMap


    let predicate = Quake.predicate(searchText: searchText, searchDate: searchDate)
    switch sortParameter {
    case .time: _quakes = Query(filter: predicate, sort: \.time, order: sortOrder)
    case .magnitude: _quakes = Query(filter: predicate, sort: \.magnitude, order: sortOrder)
    }
}

```

These two initializers have different sorting constraints to match the needs of their respective appearances, but they use the same predicate to ensure that the set of quakes that appears in the list always matches the set that appears on the map.
## [See Also](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#see-also)
### [Model fetch](https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data#Model-fetch)
[`macro Query()`](https://developer.apple.com/documentation/swiftdata/query\(\))
Fetches all instances of the attached model type.
[API Reference Additional query macros](https://developer.apple.com/documentation/swiftdata/additionalquerymacros)
Supplementary macros that enable you to narrow query results and tell SwiftData how to sort and order those results.
[`struct Query`](https://developer.apple.com/documentation/swiftdata/query)
A type that fetches models using the specified criteria, and manages those models so they remain in sync with the underlying data.
[`struct FetchDescriptor`](https://developer.apple.com/documentation/swiftdata/fetchdescriptor)
A type that describes the criteria, sort order, and any additional configuration to use when performing a fetch.
Current page is Filtering and sorting persistent data 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fswiftdata%2Ffiltering-and-sorting-persistent-data).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
