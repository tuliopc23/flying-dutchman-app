Source: https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns

[ Skip Navigation ](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns)
  * SwiftLanguage:  Swift  Objective-C 
Language: 
    * Swift 
    * [ Objective-C ](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns)


[](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns)
## [ User Notifications  ](https://developer.apple.com/documentation/usernotifications)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
18 of 19 symbols inside -1484906498 
Troubleshooting
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
9 of 53 symbols inside <root> containing 19 symbols[Setting up a remote notification server](https://developer.apple.com/documentation/usernotifications/setting-up-a-remote-notification-server)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
1 of 19 symbols inside -1484906498 
Server tasks
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
2 of 19 symbols inside -1484906498 [Registering your app with APNs](https://developer.apple.com/documentation/usernotifications/registering-your-app-with-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
3 of 19 symbols inside -1484906498 [Generating a remote notification](https://developer.apple.com/documentation/usernotifications/generating-a-remote-notification)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
4 of 19 symbols inside -1484906498 [Pushing background updates to your App](https://developer.apple.com/documentation/usernotifications/pushing-background-updates-to-your-app)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
5 of 19 symbols inside -1484906498 [Establishing a connection to Apple Push Notification service (APNs)](https://developer.apple.com/documentation/usernotifications/establishing-a-connection-to-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
6 of 19 symbols inside -1484906498 
Security
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
7 of 19 symbols inside -1484906498 [Establishing a token-based connection to APNs](https://developer.apple.com/documentation/usernotifications/establishing-a-token-based-connection-to-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
8 of 19 symbols inside -1484906498 [Establishing a certificate-based connection to APNs](https://developer.apple.com/documentation/usernotifications/establishing-a-certificate-based-connection-to-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
9 of 19 symbols inside -1484906498 
Device push notifications
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
10 of 19 symbols inside -1484906498 [Sending notification requests to APNs](https://developer.apple.com/documentation/usernotifications/sending-notification-requests-to-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
11 of 19 symbols inside -1484906498 [Handling notification responses from APNs](https://developer.apple.com/documentation/usernotifications/handling-notification-responses-from-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
12 of 19 symbols inside -1484906498 [Viewing the status of push notifications using Metrics and APNs](https://developer.apple.com/documentation/usernotifications/viewing-the-status-of-push-notifications-using-metrics-and-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
13 of 19 symbols inside -1484906498 
Broadcast push notifications
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
14 of 19 symbols inside -1484906498 [Setting up broadcast push notifications](https://developer.apple.com/documentation/usernotifications/setting-up-broadcast-push-notifications)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
15 of 19 symbols inside -1484906498 [Sending channel management requests to APNs](https://developer.apple.com/documentation/usernotifications/sending-channel-management-requests-to-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
16 of 19 symbols inside -1484906498 [Sending broadcast push notification requests to APNs](https://developer.apple.com/documentation/usernotifications/sending-broadcast-push-notification-requests-to-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
17 of 19 symbols inside -1484906498 [Handling error responses from Apple Push Notification service](https://developer.apple.com/documentation/usernotifications/handling-error-responses-from-apns)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
18 of 19 symbols inside -1484906498 
Troubleshooting
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
19 of 19 symbols inside -1484906498 [Troubleshooting push notifications](https://developer.apple.com/documentation/usernotifications/troubleshooting-push-notifications)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
10 of 53 symbols inside <root> [Sending push notifications using command-line tools](https://developer.apple.com/documentation/usernotifications/sending-push-notifications-using-command-line-tools)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
11 of 53 symbols inside <root> [Testing notifications using the Push Notification Console](https://developer.apple.com/documentation/usernotifications/testing-notifications-using-the-push-notification-console)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
12 of 53 symbols inside <root>
Notification requests
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
13 of 53 symbols inside <root> containing 2 symbols[Scheduling a notification locally from your app](https://developer.apple.com/documentation/usernotifications/scheduling-a-notification-locally-from-your-app)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
14 of 53 symbols inside <root> containing 6 symbols[UNNotificationRequest](https://developer.apple.com/documentation/usernotifications/unnotificationrequest)
72 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ User Notifications ](https://developer.apple.com/documentation/usernotifications)
  * [ Setting up a remote notification server ](https://developer.apple.com/documentation/usernotifications/setting-up-a-remote-notification-server)
  * [ Establishing a token-based connection to APNs ](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns)
  *     * [ Setting up a remote notification server ](https://developer.apple.com/documentation/usernotifications/setting-up-a-remote-notification-server)
    * Establishing a token-based connection to APNs 


Article
# Establishing a token-based connection to APNs
Secure your communications with Apple Push Notification service (APNs) by using stateless authentication tokens.
## [Overview](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#overview)
Token-based authentication offers a stateless way to communicate with APNs. Stateless communication is faster than certificate-based communication because it doesn’t require APNs to look up the certificate, or other information, related to your provider server. There are other advantages to using token-based authentication:
  * You can use the same token from multiple provider servers.
  * You can use one token to distribute notifications for all or a subset of your company’s apps.


Token-based requests are slightly larger than certificate-based requests because each request contains the token. You must also update and encrypt your tokens at least once an hour using the provider token signing key that Apple provides you. To learn more about key creation, see [Create a private key to access a service](https://developer.apple.com/help/account/manage-keys/create-a-private-key/).
### [Team-scoped keys](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#Team-scoped-keys)
Use team-scoped keys to generate authentication tokens for sending notifications to any topic in a team. These keys restrict usage to either Sandbox or Production, enhancing security. They apply to all existing and new topics in the team. Each environment can have a maximum of two keys.
Important
If you have existing team-scoped keys that work in both the Sandbox and Production environments it will continue to be supported. However, it’s recommended to use different, environment-specific keys to create distinct workflows and to safely manage your development process.
### [Topic-specific keys](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#Topic-specific-keys)
Use topic-specific keys to generate authentication tokens for sending notifications to specific team topics within a single environment. These keys provide granular control and simplify management. You can create a maximum of 200 keys for Sandbox and 200 for Production, with up to 400 topics per topic-based key.
A topic-specific key can have at most one related key in the same environment. When you connect to the APNs server, you can use authentication tokens from both the topic-based key and its related key (if available) for push notification requests.
Important
APNs doesn’t support authentication tokens from multiple developer accounts over a single connection.
### [Obtain an encryption key and key ID from Apple](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#Obtain-an-encryption-key-and-key-ID-from-Apple)
You need an APNs authentication token signing key to generate the tokens that your server uses. You request this key from your developer account on [developer.apple.com](https://developer.apple.com/account/resources/keys/list), as shown in the following image:
![Creating an authentication token signing key that supports APNs in your developer account.](https://docs-assets.developer.apple.com/published/0f5993178cc36a886c29a80f8178ef21/media-4286508%402x.png)
When you request a key, Apple gives you:
  * A 10-character string with the Key ID. You must include this string in your JSON tokens. You can find instructions to get this ID in [Get a key identifier](https://developer.apple.com/help/account/manage-keys/get-a-key-identifier).
  * An authentication token signing key, specified as a text file (with a `.p8` file extension).


Secure both pieces of information carefully. You use the authentication token signing key to encrypt your JSON tokens, so this key must remain private to prevent anyone else from generating those tokens.
Important
If you suspect that you may have a compromised authentication token signing key, revoke it and request a new one. (You revoke the key from your developer account on [developer.apple.com](https://developer.apple.com) in the same place where you created it). For maximum security, close all of your existing HTTP/2 connections to APNs and establish new connections before making new requests.
For detailed instructions on how to use an authentication token, see the `authorization` header field in [Sending notification requests to APNs](https://developer.apple.com/documentation/usernotifications/sending-notification-requests-to-apns).
### [Create and encrypt your JSON token](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#Create-and-encrypt-your-JSON-token)
The token that you include with your notification requests uses the JSON Web Token (JWT) specification. The following table describes the four key-value pairs the token itself contains:
`alg` | The encryption algorithm you used to encrypt the token. APNs supports only the ES256 algorithm, so set the value of this key to `ES256`.  
---|---  
`kid` | The 10-character Key ID you obtained from your developer account; see [Get a key identifier](https://developer.apple.com/help/account/manage-keys/get-a-key-identifier).  
`iss` | The issuer key, the value for which is the 10-character Team ID you use for developing your company’s apps. Obtain this value from your developer account.  
`iat` | The “issued at” time, whose value indicates the time when the JSON token generated. Specify the value as the number of seconds since Epoch, in UTC. The value must be no more than one hour from the current time.  
The keys divide between the header and claims payload of the JSON Web Token. The header of the token contains the encryption algorithm and Key ID, and the claims payload contains your Team ID and the token generation time. The code snippet below shows an example of a JSON token for a fictional developer account.
```
{
   "alg" : "ES256",
   "kid" : "ABC123DEFG"
}
{
   "iss": "DEF123GHIJ",
   "iat": 1437179036
}

```

Important
If the value in the `iat` field is more than one hour old, APNs rejects any notifications containing the token, returning an `ExpiredProviderToken` `(403)` error.
Encrypt the resulting JSON data using your authentication token signing key and the specified algorithm. Your provider server must include the resulting encrypted data with all notification requests.
For detailed information about the JWT specification, see [RFC 7519](https://tools.ietf.org/html/rfc7519).
### [Attach your token to notification requests](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#Attach-your-token-to-notification-requests)
When creating the POST request for a notification, include your encrypted token in the `authorization` header of your request. The token is in Base64URL-encoded JWT format, and is specified as `bearer <token data>`, as shown in the following example:
```
authorization = bearer eyAia2lkIjogIjhZTDNHM1JSWDciIH0.eyAiaXNzIjogIkM4Nk5WOUpYM0QiLCAiaWF0I
		 jogIjE0NTkxNDM1ODA2NTAiIH0.MEYCIQDzqyahmH1rz1s-LFNkylXEa2lZ_aOCX4daxxTZkVEGzwIhALvkClnx5m5eAT6
		 Lxw7LZtEQcH6JENhJTMArwLf3sXwi



```

For information on how to construct your POST requests, see [Sending notification requests to APNs](https://developer.apple.com/documentation/usernotifications/sending-notification-requests-to-apns).
### [Refresh your token regularly](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#Refresh-your-token-regularly)
For security, APNs requires you to refresh your token regularly. Refresh your token no more than once every 20 minutes and no less than once every 60 minutes. APNs rejects any request whose token contains a timestamp that’s more than one hour old. Similarly, APNs report an error if you use a new token more than once every 20 minutes on the same connection.
On your provider server, set up a recurring task to recreate your token with a current timestamp. Encrypt the token again and attach it to subsequent notification requests.
### [Team and bundle ID mapping](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#Team-and-bundle-ID-mapping)
You can’t map a connection to APNs to multiple teams. If you manage APNs for multiple developer accounts, open separate connection pools for each of them.
As part of the authentication process, APNs relates a team ID and associated bundle IDs to a connection on the first push. After the authentication process, attempting to associate a different team or sending a push to a newly added bundle ID causes an error. To send remote notifications to a new topic, add the topic to your team in App Store Connect and create new connections to APNs.
For transferred apps, close and recreate any existing connections from your push provider server to APNs. If you don’t, APNs can’t start accepting push requests from the new team.
Important
If you use a token from a team-scoped key during the first push, trying to send a push with a topic-specific key or a team-scoped key from a different environment results in an error. After you establish a connection with a topic-specific key for the initial push, using an unrelated topic-specific key, a key from a different environment, a team-scoped key, or sending to a nonassociated topic also results in an error.
## [See Also](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#see-also)
### [Security](https://developer.apple.com/documentation/UserNotifications/establishing-a-token-based-connection-to-apns#Security)
[Establishing a certificate-based connection to APNs](https://developer.apple.com/documentation/usernotifications/establishing-a-certificate-based-connection-to-apns)
Secure your communications with Apple Push Notification service (APNs) by installing a certificate on your provider server.
Current page is Establishing a token-based connection to APNs 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2FUserNotifications%2Festablishing-a-token-based-connection-to-apns).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
