Source: https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app

[ Skip Navigation ](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#app-main)
  * [Global Nav Open Menu](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#ac-gn-menustate)[Global Nav Close Menu](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app)
  * [Apple Developer](https://developer.apple.com/)


[ Search Developer Cancel  ](https://developer.apple.com/search/)
  * [Apple Developer](https://developer.apple.com/)
  * [News](https://developer.apple.com/news/)
  * [Discover](https://developer.apple.com/discover/)
  * [Design](https://developer.apple.com/design/)
  * [Develop](https://developer.apple.com/develop/)
  * [Distribute](https://developer.apple.com/distribute/)
  * [Support](https://developer.apple.com/support/)
  * [Account](https://developer.apple.com/account/)
  * [](https://developer.apple.com/search/)


Cancel 
Only search within “Documentation”
### Quick Links
  * [Downloads](https://developer.apple.com/download/)
  * [Documentation](https://developer.apple.com/documentation/)
  * [Sample Code](https://developer.apple.com/documentation/samplecode/)
  * [Videos](https://developer.apple.com/videos/)
  * [Forums](https://developer.apple.com/forums/)

5 Quick Links
[ Documentation ](https://developer.apple.com/documentation)
[ Open Menu ](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app)
  * SwiftLanguage:  Swift  Objective-C 
Language: 
    * Swift 
    * [ Objective-C ](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app)


[](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app)
## [ Core Data  ](https://developer.apple.com/documentation/coredata)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
27 of 37 symbols inside <root>
Background tasks
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
9 of 37 symbols inside <root> containing 13 symbols[Core Data model](https://developer.apple.com/documentation/coredata/core-data-model)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
10 of 37 symbols inside <root>
Fetch requests
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
11 of 37 symbols inside <root> containing 35 symbols[NSFetchRequest](https://developer.apple.com/documentation/coredata/nsfetchrequest)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
12 of 37 symbols inside <root> containing 6 symbols[NSAsynchronousFetchRequest](https://developer.apple.com/documentation/coredata/nsasynchronousfetchrequest)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
13 of 37 symbols inside <root> containing 3 symbols[NSAsynchronousFetchResult](https://developer.apple.com/documentation/coredata/nsasynchronousfetchresult)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
14 of 37 symbols inside <root> containing 25 symbols[NSFetchedResultsController](https://developer.apple.com/documentation/coredata/nsfetchedresultscontroller)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
15 of 37 symbols inside <root>
SwiftData migration and coexistence
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
16 of 37 symbols inside <root> [Adopting SwiftData for a Core Data app](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
17 of 37 symbols inside <root>
CloudKit mirroring
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
18 of 37 symbols inside <root> containing 5 symbols[Mirroring a Core Data store with CloudKit](https://developer.apple.com/documentation/coredata/mirroring-a-core-data-store-with-cloudkit)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
19 of 37 symbols inside <root> [Synchronizing a local store to the cloud](https://developer.apple.com/documentation/coredata/synchronizing-a-local-store-to-the-cloud)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
20 of 37 symbols inside <root> containing 16 symbols[NSPersistentCloudKitContainer](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontainer)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
C
21 of 37 symbols inside <root> containing 4 symbols[NSPersistentCloudKitContainerOptions](https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontaineroptions)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
22 of 37 symbols inside <root> [Sharing Core Data objects between iCloud users](https://developer.apple.com/documentation/coredata/sharing-core-data-objects-between-icloud-users)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
23 of 37 symbols inside <root>
Change processing
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
24 of 37 symbols inside <root> [Accessing data when the store changes](https://developer.apple.com/documentation/coredata/accessing-data-when-the-store-changes)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
25 of 37 symbols inside <root> [Consuming relevant store changes](https://developer.apple.com/documentation/coredata/consuming-relevant-store-changes)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
26 of 37 symbols inside <root> containing 8 symbols[Persistent history](https://developer.apple.com/documentation/coredata/persistent-history)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
27 of 37 symbols inside <root>
Background tasks
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
28 of 37 symbols inside <root> [Using Core Data in the background](https://developer.apple.com/documentation/coredata/using-core-data-in-the-background)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
29 of 37 symbols inside <root> [Loading and displaying a large data feed](https://developer.apple.com/documentation/swiftui/loading-and-displaying-a-large-data-feed)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
30 of 37 symbols inside <root> containing 5 symbols[Conflict resolution](https://developer.apple.com/documentation/coredata/conflict-resolution)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
Collection
31 of 37 symbols inside <root> containing 9 symbols[Batch processing](https://developer.apple.com/documentation/coredata/batch-processing)
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
32 of 37 symbols inside <root>
Data model migration
To navigate the symbols, press Up Arrow, Down Arrow, Left Arrow or Right Arrow 
33 of 37 symbols inside <root> [Migrating your data model automatically](https://developer.apple.com/documentation/coredata/migrating-your-data-model-automatically)
37 items were found. Tab back to navigate through them. 
/ 
Navigator is ready 
  * [ Core Data ](https://developer.apple.com/documentation/coredata)
  * [ Adopting SwiftData for a Core Data app ](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app)
  *     * Adopting SwiftData for a Core Data app 


Sample Code
# Adopting SwiftData for a Core Data app
Persist data in your app intuitively with the Swift native persistence framework.
[ Download ](https://docs-assets.developer.apple.com/published/03675934b2ed/AdoptingSwiftDataForACoreDataApp.zip)
iOS 26.0+iPadOS 26.0+macOS 26.0+Xcode 26.0+
## [Overview](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Overview)
This sample project is designed to help you understand how to adopt SwiftData in an existing Core Data app. The SampleTrips app fetches and displays all upcoming trips from the store, and allows people to create or remove trips, and to add, update, or remove information from the itinerary for each trip. There are three versions of this app:
  * A Core Data version that demonstrates Core Data best practices.
  * A SwiftData version that shows the complete app conversion from Core Data to SwiftData.
  * A coexistence version, where the sample app uses Core Data, and adds a widget extension that uses SwiftData. This version covers a scenario where you might want to adopt SwiftData incrementally, or for certain portions of your app.


### [Configure the sample code project](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Configure-the-sample-code-project)
Open the sample code project in Xcode. Before building it, do the following:
  1. Set the developer team for all targets to your team so Xcode automatically manages the provisioning profile. For more information, see [Assign a project to a team](https://help.apple.com/xcode/mac/current/#/dev23aab79b4).
  2. Replace the App Group container identifier — `group.com.example.apple-samplecode.SampleTrips` — with one specific to your team for the entire project. The identifier points to an App Group container that the app and widget use to share data. You can search for `group.com.example.apple-samplecode.SampleTrips` using the Find navigator in Xcode, and then change all of the occurrences. For more information, see [Configuring app groups](https://developer.apple.com/documentation/Xcode/configuring-app-groups).


### [Adopt SwiftData](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Adopt-SwiftData)
The SwiftData sample sets up the schema with Swift types that conform to the [`PersistentModel`](https://developer.apple.com/documentation/SwiftData/PersistentModel) protocol, which captures information about the app’s types, including properties and relationships. Each model file corresponds to an individual entity, with identical entity names, properties, and relationships as its Core Data counterpart.
Each model file in this sample uses the [`Model()`](https://developer.apple.com/documentation/SwiftData/Model\(\)) macro to add necessary conformances for the `PersistentModel` and [`Observable`](https://developer.apple.com/documentation/Observation/Observable) protocols:
```
@Model class Trip {
    #Index<Trip>([\.name], [\.startDate], [\.endDate], [\.name, \.startDate, \.endDate])
    #Unique<Trip>([\.name, \.startDate, \.endDate])
    
    @Attribute(.preserveValueOnDeletion)
    var name: String
    var destination: String
    
    @Attribute(.preserveValueOnDeletion)
    var startDate: Date
    
    @Attribute(.preserveValueOnDeletion)
    var endDate: Date


    @Relationship(deleteRule: .cascade, inverse: \BucketListItem.trip)
    var bucketList: [BucketListItem] = [BucketListItem]()
    
    @Relationship(deleteRule: .cascade, inverse: \LivingAccommodation.trip)
    var livingAccommodation: LivingAccommodation?
    ...

```

Additionally, the app sets up the container using [`ModelContainer`](https://developer.apple.com/documentation/SwiftData/ModelContainer) to ensure that all views access the same `ModelContainer`.
```
.modelContainer(modelContainer)

```

Setting up the `ModelContainer` also creates and sets a default [`ModelContext`](https://developer.apple.com/documentation/SwiftData/ModelContext) in the environment. The app can access the `ModelContext` from any scene or view using an environment property.
```
@Environment(\.modelContext) private var modelContext

```

### [Create a persisted data object](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Create-a-persisted-data-object)
This app creates a new instance of a trip and inserts it into the [`ModelContext`](https://developer.apple.com/documentation/SwiftData/ModelContext) for persistence:
```
if newTripSegment == .personal {
    newTrip = PersonalTrip(name: name, destination: destination, startDate: startDate, endDate: endDate, reason: reason)
} else if newTripSegment == .business {
    newTrip = BusinessTrip(name: name, destination: destination, startDate: startDate, endDate: endDate, perdiem: perdiem)
} else {
    newTrip = Trip(name: name, destination: destination, startDate: startDate, endDate: endDate)
}
modelContext.insert(newTrip)

```

### [Persist data](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Persist-data)
The app uses the SwiftData implicit save feature to persist data. This implicit save occurs on UI life cycle events and on a timer after the context changes. For more information about enabling autosave, see the [`autosaveEnabled`](https://developer.apple.com/documentation/SwiftData/ModelContext/autosaveEnabled) property.
The app calls [`delete(_:)`](https://developer.apple.com/documentation/SwiftData/ModelContext/delete\(_:\)) on the [`ModelContext`](https://developer.apple.com/documentation/SwiftData/ModelContext) with the instance to delete.
```
modelContext.delete(trip)

```

### [Fetch persisted data](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Fetch-persisted-data)
This sample app fetches the complete list of upcoming trips by wrapping an array of trips in a [`Query`](https://developer.apple.com/documentation/SwiftData/Query) macro, which fetches `Trip` objects from the container.
```
@Query(sort: \Trip.startDate, order: .forward)
var trips: [Trip]

```

This sample also fetches data by calling [`fetch(_:)`](https://developer.apple.com/documentation/SwiftData/ModelContext/fetch\(_:\)) on the [`ModelContext`](https://developer.apple.com/documentation/SwiftData/ModelContext) and passing in a [`FetchDescriptor`](https://developer.apple.com/documentation/SwiftData/FetchDescriptor) that specifies both the entity to retrieve data from as well as a corresponding [`Predicate`](https://developer.apple.com/documentation/Foundation/Predicate) that specifies the conditions for the object to fetch.
```
var descriptor = FetchDescriptor<BucketListItem>()
let tripName = trip.name
descriptor.predicate = #Predicate { item in
    item.title.contains(searchText) && tripName == item.trip?.name
}
let filteredList = try? modelContext.fetch(descriptor)

```

### [Inheritance](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Inheritance)
The SwiftData-Inheritance version of the app extends the `Trip` class into two distinct kinds of Trips, `PersonalTrip` and `BusinessTrip`, building on the basic `Trip` model to include more specialized properties for different kinds of Trips.
```
class PersonalTrip: Trip {...}

```

Both `PersonalTrip` and `BusinessTrip` inherit basic properties from their superclass, `Trip`, while defining their own specialized properties, as shown in the following code. For instance, `PersonalTrip`, has an additional property that describes the reason for the trip.
```
init(name: String, destination: String, startDate: Date = .now, endDate: Date = .distantFuture, reason: Reason) {
    self.reason = reason
    super.init(name: name, destination: destination, startDate: startDate, endDate: endDate)
}

```

### [Coexistence between Core Data and SwiftData](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Coexistence-between-Core-Data-and-SwiftData)
The coexistence version of the app has two persistence stacks: a Core Data persistence stack for the host app, and a SwiftData persistence stack for the widget extension. Both stacks write to the same store file.
### [Namespace models](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Namespace-models)
The namespaces in the coexistence sample use the pre-existing [`NSManagedObject`](https://developer.apple.com/documentation/CoreData/NSManagedObject)-based entity subclasses so that they don’t conflict with the SwiftData classes. Note that this refers to the class name, not the entity name.
```
class CDTrip: NSManagedObject {...}

```

The sample then refers to the entity as `CDTrip` when accessing it in the Core Data host app. For instance, when adding a new `Trip`:
```
let newTrip = CDTrip(context: viewContext)

```

### [Share the same store file](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Share-the-same-store-file)
This sample ensures that both the Core Data and SwiftData persistent stacks write to the same store file by setting the persistent store URL for the container description:
```
if let description = container.persistentStoreDescriptions.first {
    description.url = url
    ...
}

```

Additionally, the coexistence sample must set the [`NSPersistentHistoryTrackingKey`](https://developer.apple.com/documentation/CoreData/NSPersistentHistoryTrackingKey). Although SwiftData enables persistent history tracking automatically, Core Data does not, so the app enables persistent history manually.
```
description.setOption(true as NSNumber, forKey: NSPersistentHistoryTrackingKey)

```

By default, SwiftData behaves in the following way when determining where it persists data:
  * It persists data store to the app’s Application Support directory.
  * This sample app uses App Groups to access shared containers and share data between the SwiftData widget extension and the Core Data host app. For an app that has the [`App Groups Entitlement`](https://developer.apple.com/documentation/BundleResources/Entitlements/com.apple.security.application-groups), it persists the data store to the root directory of the app group container. For apps that evolve from a version that doesn’t have any app group container to a version that has one, SwiftData copies the existing store to the app group container.


In this sample, the main app and widget share the same store via an app group container, and the store is located in the default location in the app group container. To ensure SwiftData accesses the same store, the main app and widget both share the [`ModelContainer`](https://developer.apple.com/documentation/SwiftData/ModelContainer).
### [Detect relevant changes by consuming the SwiftData history](https://developer.apple.com/documentation/coredata/adopting-swiftdata-for-a-core-data-app#Detect-relevant-changes-by-consuming-the-SwiftData-history)
In the SwiftData version, people can confirm the living accommodation for the current trip by tapping the Accommodation button in the widget. The widget then updates `LivingAccommodation.isConfirmed` in SwiftData, and the main app, when entering the foreground, detects the changes and annotates the trip with a blue dot to indicate that it has unread changes.
There are multiple options for the main app to detect the changes from the widget:
  1. Adding a key value pair to the shared `UserDefaults` ([`init(suiteName:)`](https://developer.apple.com/documentation/Foundation/UserDefaults/init\(suiteName:\)) for the widget and the main app to share the changes.
  2. Adding a new attribute in `Trip` so the widget can mark the trip as “unread” when changing the living accommodation status.
  3. Consuming the history of the store, which SwiftData generates by default, and picking up the relevant changes from there.


The first option introduces a new storage, and hence needs to maintain the consistency between SwiftData and the shared `UserDefaults`. The second option is easier to implement, but introduces and maintains a new attribute, which is redundant and consumes extra storage space; for real-world apps that manage more complicated changes and have larger data set, that may not be the favorite approach.
This sample chooses to detect the changes with the third option. To do so, it sets up a `HistoryDescriptor<DefaultHistoryTransaction>` with a history token (`DefaultHistoryToken`) and calls `fetchHistory(_:)` to retrieve the history transactions (`DefaultHistoryTransaction`) after the token, as shown in the following code:
```
private func findTransactions(after historyToken: DefaultHistoryToken?, author: String) -> [DefaultHistoryTransaction] {...}

```

After getting the transactions, it uses the following code to find the trips that have living accommodation changes:
```
private func findTrips(in transactions: [DefaultHistoryTransaction]) -> (Set<Trip>, DefaultHistoryToken?) {...}

```

Current page is Adopting SwiftData for a Core Data app 
[Apple](https://www.apple.com)
  1. [Developer](https://developer.apple.com/)
  2. [ Documentation ](https://developer.apple.com/documentation/)


###  Platforms 
Toggle Menu 
  * [iOS](https://developer.apple.com/ios/)
  * [iPadOS](https://developer.apple.com/ipados/)
  * [macOS](https://developer.apple.com/macos/)
  * [tvOS](https://developer.apple.com/tvos/)
  * [visionOS](https://developer.apple.com/visionos/)
  * [watchOS](https://developer.apple.com/watchos/)


###  Tools 
Toggle Menu 
  * [Swift](https://developer.apple.com/swift/)
  * [SwiftUI](https://developer.apple.com/swiftui/)
  * [Swift Playground](https://developer.apple.com/swift-playground/)
  * [TestFlight](https://developer.apple.com/testflight/)
  * [Xcode](https://developer.apple.com/xcode/)
  * [Xcode Cloud](https://developer.apple.com/xcode-cloud/)
  * [SF Symbols](https://developer.apple.com/sf-symbols/)


###  Topics & Technologies 
Toggle Menu 
  * [Accessibility](https://developer.apple.com/accessibility/)
  * [Accessories](https://developer.apple.com/accessories/)
  * [App Extension](https://developer.apple.com/app-extensions/)
  * [App Store](https://developer.apple.com/app-store/)
  * [Audio & Video](https://developer.apple.com/audio/)
  * [Augmented Reality](https://developer.apple.com/augmented-reality/)
  * [Design](https://developer.apple.com/design/)
  * [Distribution](https://developer.apple.com/distribute/)
  * [Education](https://developer.apple.com/education/)
  * [Fonts](https://developer.apple.com/fonts/)
  * [Games](https://developer.apple.com/games/)
  * [Health & Fitness](https://developer.apple.com/health-fitness/)
  * [In-App Purchase](https://developer.apple.com/in-app-purchase/)
  * [Localization](https://developer.apple.com/localization/)
  * [Maps & Location](https://developer.apple.com/maps/)
  * [Machine Learning & AI](https://developer.apple.com/machine-learning/)
  * [Open Source](https://opensource.apple.com/)
  * [Security](https://developer.apple.com/security/)
  * [Safari & Web](https://developer.apple.com/safari/)


###  Resources 
Toggle Menu 
  *   * [Documentation](https://developer.apple.com/documentation/)
  * [Tutorials](https://developer.apple.com/learn/)
  * [Downloads](https://developer.apple.com/download/)
  * [Forums](https://developer.apple.com/forums/)
  * [Videos](https://developer.apple.com/videos/)


###  Support 
Toggle Menu 
  * [Support Articles](https://developer.apple.com/support/articles/)
  * [Contact Us](https://developer.apple.com/contact/)
  * [Bug Reporting](https://developer.apple.com/bug-reporting/)
  * [System Status](https://developer.apple.com/system-status/)


###  Account 
Toggle Menu 
  * [Apple Developer](https://developer.apple.com/account/)
  * [App Store Connect](https://appstoreconnect.apple.com/)
  * [Certificates, IDs, & Profiles](https://developer.apple.com/account/ios/certificate/)
  * [Feedback Assistant](https://feedbackassistant.apple.com/)


###  Programs 
Toggle Menu 
  * [Apple Developer Program](https://developer.apple.com/programs/)
  * [Apple Developer Enterprise Program](https://developer.apple.com/programs/enterprise/)
  * [App Store Small Business Program](https://developer.apple.com/app-store/small-business-program/)
  * [MFi Program](https://mfi.apple.com/)
  * [News Partner Program](https://developer.apple.com/programs/news-partner/)
  * [Video Partner Program](https://developer.apple.com/programs/video-partner/)
  * [Security Bounty Program](https://developer.apple.com/security-bounty/)
  * [Security Research Device Program](https://developer.apple.com/programs/security-research-device/)


###  Events 
Toggle Menu 
  * [Meet with Apple](https://developer.apple.com/events/)
  * [Apple Developer Centers](https://developer.apple.com/events/developer-centers/)
  * [App Store Awards](https://developer.apple.com/app-store/app-store-awards/)
  * [Apple Design Awards](https://developer.apple.com/design/awards/)
  * [Apple Developer Academies](https://developer.apple.com/academies/)
  * [WWDC](https://developer.apple.com/wwdc/)


To submit feedback on documentation, visit [Feedback Assistant](applefeedback://new?form_identifier=developertools.fba&answers%5B%3Aarea%5D=seedADC%3Adevpubs&answers%5B%3Adoc_type_req%5D=Technology%20Documentation&answers%5B%3Adocumentation_link_req%5D=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fcoredata%2Fadopting-swiftdata-for-a-core-data-app).
Select a color scheme preference
Light
Dark
Auto
Copyright © 2025 [Apple Inc.](https://www.apple.com) All rights reserved. 
[ Terms of Use ](https://www.apple.com/legal/internet-services/terms/site.html)[ Privacy Policy ](https://www.apple.com/legal/privacy/)[ Agreements and Guidelines ](https://developer.apple.com/support/terms/)
